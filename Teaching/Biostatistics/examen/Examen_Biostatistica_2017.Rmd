---
title: "Examen"
subtitle: "Timp de lucru 1h30^[Toate documentele și calculatoarele electronice de mână sunt autorizate. Computerele personale, telefoanele mobile/smartwatch-urile sunt **strict interzise**.]"
output:
  pdf_document:
    includes:
      before_body: Defs/body.tex
      in_header: Defs/FormatAndDefs.tex
    keep_tex: yes
    toc: no
  html_document:
    fig_caption: yes
    toc: yes
    toc_float:
      collapsed: no
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(knitr)

# Exercitiul 1: Casella and Berger Ex11.32
# Exercitiul 2: Casella and Berger Ex11.33 + Regression avec R Ex 1.10
# Exercitiul 3: 
```

<style type="text/css">
.table {
    margin: auto;
    width: 40%;

}

</style>

### Exercițiul 1

Să presupunem că observațiile $(x_i,Y_i)$, $i=1,\ldots,n$ sunt făcute după modelul $Y_i = \alpha + \beta x_i + \varepsilon_i$, unde $x_1,\ldots,x_n$ sunt constante iar $\varepsilon_1,\ldots,\varepsilon_n\sim \mathcal{N}(0,\sigma^2)$ sunt independente. Modelul este apoi reparametrizat astfel

$$
Y_i = \alpha' + \beta' (x_i-\bar{x}) + \varepsilon_i.
$$

Fie $\hat{\alpha}$ și $\hat{\beta}$ estimatorii de verosimilate maximă a lui $\alpha$ și $\beta$, iar $\hat{\alpha}'$ și $\hat{\beta}'$ estimatorii de verosimilitate maximă a lui $\alpha'$ și $\beta'$.

  a) Arătați că $\hat{\beta}' = \hat{\beta}$.
  
  b) Arătați că $\hat{\alpha}' \neq \hat{\alpha}$ și găsiți repartiția lui $\hat{\alpha}'$.
  
  c) Arătați că $\hat{\alpha}'$ și $\hat{\beta}'$ sunt necorelați, prin urmare sub ipoteza de normalitate sunt independenți.
  
  
### Exercițiul 2

Căutăm să exprimăm înălțimea unui arbore $Y$ în funcție de diametrul său $X$ calculat la 1.3 m de sol. Pentru aceasta am măsurat 20 de cupluri *diametru-înălțime* dintr-o populație normală bivariată cu parametrii $(\mu_X, \mu_Y, \sigma_X, \sigma_Y, \rho)$ și am obținut valorile următoare:

```{r, echo=FALSE, comment=""}
rbvn<-function (n, mu1, s1, mu2, s2, rho) 
  {
     X1 <- rnorm(n, mu1, s1)
     X2 <- rnorm(n, mu2 + (s2/s1) * rho * 
           (X1 - mu1), sqrt((1 - rho^2)*s2^2))
     cbind(X1, X2)
}

bvn <- rbvn(20, 35, 1.9, 18.5, 0.05, 0.7)
colnames(bvn) <- c("X","Y")
bvn = round(bvn, digits = 1)
t(bvn)
# kable(bvn, align = "cc")
```

  a) Determinați ecuația dreptei de regresie (pentru modelul condiționat) $Y_i = \beta_0 + \beta_1 x_i + \varepsilon_i$.
  
  b) Verificați că ipoteza $H_0:\, \beta_1=0$ este adevărată dacă și numai dacă ipoteza $H_0:\, \rho=0$ este adevărată.
  
  c) Arătați că 
  
  $$
    \frac{\hat{\beta_1}}{S/\sqrt{S_{xx}}}=\sqrt{n-2}\frac{r}{\sqrt{1-r^2}}
  $$
  
  unde $r$ este coeficientul de corelație empiric (EVM pentru $\rho$).
  
  d) Determinați tabelul ANOVA pentru regresie și testați ipotezele $H_0:\, \beta_j=0$ versus $H_1:\,\beta_j\neq0$, $j\in\{0,1\}$. Ce credeți despre rezultat ?
  
  e) Dați un test pentru ipoteza $H_0:\, \rho = 0$ care să depindă doar de $r^2$ și de $n$.
  
  f) Să presupunem că am observat un arbore de diametru $x_0=36$. Determinați un interval de predicție pentru înălțimea arborelui. 
 
```{r, include=FALSE, echo=FALSE}

dat = data.frame(X = c(35.8, 33.4, 32.3, 30.1, 39.5, 36.5, 30.3, 36.2, 34.0, 33.7, 32.8, 36.9, 34.4, 31.3, 35.6, 36.4,
                       33.9, 37.6, 36.3, 35.7), 
                 Y = c(18.5, 18.5, 18.5, 18.4, 18.7, 18.5, 18.4, 18.6, 18.5, 18.4, 18.5, 18.5, 18.5, 18.5, 18.5, 18.6,
                       18.5, 18.5, 18.5, 18.5), stringsAsFactors = FALSE)
ndat = data.frame(X = 36)

model1 = lm(Y~X, data = dat)
s_model1 = summary(model1)
predict(model1, ndat, interval = "prediction")
```


---
title: "Laborator 6"
subtitle: Repartiții continue (univariate)
output:
  html_document:
    code_folding: show
    css: lab_css/labs.css
    keep_md: yes
    number_sections: yes
    toc: yes
    toc_float:
      collapsed: no
      smooth_scroll: yes
    includes:
      in_header: lab_header/lab_header.html
      after_body: lab_header/lab_footer.html
  pdf_document:
    includes:
      before_body: tex/body.tex
      in_header: tex/preamble.tex
    keep_tex: yes
    number_sections: yes
  word_document:
    fig_caption: yes
    highlight: pygments
    keep_md: yes
    reference_docx: template/template.docx
    toc: no
bibliography: references/ProbStat2019ref.bib
---

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 60
    };
    options.showAndHide = false;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

Obiectivul acestui laborator este de a prezenta o parte din cele mai cunoscute repartiții continue^[Pentru mai multe informații, se poate consulta monografia Johnson, N., Kotz, S. și Balakrishnan, N. *Continuous Univariate Distributions*, (Volumul 1, Ediția a 2-a), John Wiley & Sons, New York (1994), 756 pp., ISBN 0-471-58495-9] și de a rezolva câteva probleme cu ajutorul lor.

```{r, echo=FALSE}
library(knitr)
library(kableExtra) # new table styles
library(latex2exp)
# library(ExtDist) # pentru repartitia Laplace

knitr::opts_chunk$set(comment = NA, prompt = FALSE, collapse = TRUE, error = TRUE, fig.align = 'center',
                      warning = FALSE, message = FALSE)

source("functions/getOutputFormat.R")

if (getOutputFormat() == "pdf_document"){
  source("functions/figureNumber_tex.R")
  source("functions/tableNumber_tex.R")
  options(knitr.table.format = "latex") # add format latex 
  dimplot = "70%"
  dimplot2 = "80%"
  engine_block = "block"
}else{
  source("functions/figureNumber.R")
  source("functions/tableNumber.R")
  options(knitr.table.format = "html") # add format html 
  dimplot = "80%"
  dimplot2 = "90%"
  engine_block = "block2"
}
```

```{r, echo = FALSE}
# Setup colors and other
myred = "#df4c44"
myblue = "#2169a4"
mybrown = "#846d4b"
myfreen = "forestgreen"

col_border = "royalblue"
col_fill = "grey80"
```



R pune la disploziție majoritatea repartițiilor uzuale. Tabelul de mai jos prezintă numele și parametrii acestora:

| Repartiția | Nume | Parametrii | Valori prestabilite |
|:--------------------------|:------------------------|:----------------------|:-----------------------------|
| Uniformă | `unif` | `min`, `max` | `min = 0`, `max = 1` |
| Normală | `norm` | `mean`, `sd` | `mean = 0`, `sd = 1` | 
| Log-Normală | `lnorm` | `mean`, `sd` | `mean = 0`, `sd = 1` | 
| Exponențială | `exp`  | `rate` (=1/mean) |  `rate = 1`  |
| Cauchy | `cauchy` | `location`, `scale` | `location = 0`, `scale = 1` |
| Gamma | `gamma` | `shape`, `rate` (=1/scale) | `rate = 1` |
| Beta | `beta` | `shape1`, `shape2` |  |
| Student | `t` | `df` |  |
| Chi-Squared | `chisq` | `df` |  |
| Fisher | `f`  | `df1`, `df2` |  |
| Weibull | `weibull` | `shape` |  |

Table: `r tn("Numele si parametrii repartitiilor uzuale in R")`

Pentru fiecare repartiție, există patru comenzi în R prefixate cu literele `d`, `p`, `q` și `r` și urmate de numele repartiției (coloana a 2-a). De exemplu `dnorm`, `pnorm`, `qnorm` și `rnorm` sunt comenzile corespunzătoare repartiției normale pe când `dunif`, `punif`, `qunif` și `runif` sunt cele corespunzătoare repartiției uniforme.

  * `dnume`: calculează densitatea atunci când vorbim de o variabilă continuă sau funcția de masă atunci când avem o repartiție discretă ($\mathbb{P}(X=k)$)
  
  * `pnume`: calculează funcția de repartiție, i.e. $F(x)=\mathbb{P}(X\leq x)$
  
  * `qnume`: reprezintă funcția cuantilă, cu alte cuvinte valoarea pentru care funcția de repartiție are o anumită probabilitate; în cazul continuu, dacă `pnume(x) = p` atunci `qnume(p) = x` iar în cazul discret întoarce cel mai mic întreg $u$ pentru care $\mathbb{P}(X\leq u)\geq p$. 
  
  * `rnume`: generează observații independente din repartiția dată 

# Repartiția Uniformă

O variabilă aleatoare $X$ repartizată *uniform* pe intervalul $[a,b]$, notată $X\sim \mathcal{U}[a,b]$, are densitatea dată de

$$
  f_X(x) = \left\{\begin{array}{ll}
    \frac{1}{b-a}, & x\in[a,b]\\
    0, & \text{altfel}
  \end{array}\right.
$$

```{r, echo = FALSE, out.width = dimplot}
a = 3
b = 7
u = seq(0, 10, by=.01)

plot(u,dunif(u, a, b),type="l", axes=FALSE,
     xlab="", ylab=TeX("$f_X(x)$"), col="white",
     main = "Densitatea repartitiei uniforme pe [a,b]",
     ylim = c(0,1))

axis(1, labels = F, tcl = 0,
     col = "grey20")
axis(2, labels = F, tcl = 0,
     col = "grey20")

I = which((u<=qunif(0.6, a, b)) & (u>=qunif(0.3, a, b)))
polygon(c(u[I], rev(u[I])), c(dunif(u, a, b)[I], rep(0,length(I))),
        col=col_fill, border=NA)
lines(u, dunif(u, a, b), lwd=3, col=col_border)

# text(5, df(5, nu1, nu2)+0.5, TeX("$X\\sim F_{\\nu_1, \\nu_2}$"), cex = 1.5)

text(8.15, 0.4, TeX("$P(\\alpha\\leq X\\leq\\beta)$"), cex = 1.25)
arrows(8, 0.35, (qunif(0.3, a, b) + qunif(0.6, a, b))/2, 0.12,
       length = 0.15, angle = 20, lty = 2)

axis(side = 1, at = c(3, qunif(0.3, a, b), qunif(0.6, a, b), 7), 
     labels = c("a", TeX("$\\alpha$"), TeX("$\\beta$"), "b"), 
     font = 2)

axis(side = 2, at = c(0, dunif(a, a, b), 1), 
     labels = c("0", TeX("$\\frac{1}{b-a}$"), "1"),
     las = 2,
     font = 2)
```

Funcția de repartiție a repartiției uniforme este 

$$
  F_X(x) =\int_{-\infty}^{x}f_X(t)\,dt = \left\{\begin{array}{ll}
    0, & x\leq a\\
    \frac{x-a}{b-a}, & x\in(a,b)\\
    1, & x\geq b
  \end{array}\right.
$$

```{r, echo=FALSE, out.width=dimplot}
a = 3
b = 7
u = seq(0, 10, by=.01)

plot(u,punif(u, a, b),type="l", axes=FALSE,
     xlab="", ylab=TeX("$F_X(x)$"), col="white",
     main = "Functia de repartitie a uniformei pe [a,b]")

axis(1, labels = F, tcl = 0,
     col = "grey20")
axis(2, labels = F, tcl = 0,
     col = "grey20")

lines(u, punif(u, a, b), lwd=3, col=col_border)

text(1.65, 0.45, TeX("$P(\\alpha\\leq X\\leq\\beta)$"), cex = 1.25)

arrows(0.25, 0.3, 0.25, 0.6,
       length = 0.15, angle = 20, lty = 2, code = 3)

segments(qunif(0.3, a, b), 0, qunif(0.3, a, b), 0.3, lty = 2)
segments(qunif(0.3, a, b), 0.3, -0.5, 0.3, lty = 2)

segments(qunif(0.6, a, b), 0, qunif(0.6, a, b), 0.6, lty = 2)
segments(qunif(0.6, a, b), 0.6, -0.5, 0.6, lty = 2)

axis(side = 1, at = c(3, qunif(0.3, a, b), qunif(0.6, a, b), 7), 
     labels = c("a", TeX("$\\alpha$"), TeX("$\\beta$"), "b"), 
     font = 2)

axis(side = 2, at = c(0, 1), 
     labels = c("0", "1"),
     las = 2,
     font = 2)
```

Media și varianța variabilei aleatoare $X$ repartizate uniform pe $[a,b]$ sunt egale cu 

$$
  \mathbb{E}[X] = \frac{a+b}{2},\qquad Var(X) = \frac{(a-b)^2}{12}. 
$$

Variabilele aleatoare repartizate uniform joacă un rol important în teoria simulării variabilelor aleatoare datorită următorului rezultat datorat lui Paul Levy și numit *teorema de universalitate a repartiției uniforme*:

```{r, type = "rmdinsight", engine = engine_block} 
Fie $X$ o variabilă aleatoare reală cu funcția de repartiție $F$, $U$ o variabilă aleatoare repartizată uniform pe $[0,1]$ și fie funcția *cuantilă* (inversa generalizată) asociată lui $F$, $F^{-1}:(0,1)\to\mathbb{R}$ definită prin 

$$
  F^{-1}(u) = \inf\{x\in\mathbb{R}\,|\,F(x)\geq u\}, \quad \forall u\in(0,1).
$$
Atunci $X$ și $F^{-1}(U)$ sunt repartizate la fel.


```

În R putem să

  - generăm observații independente din repartiția $\mathcal{U}([a, b])$ (e.g. $a = 3$ și $b = 5$)
  
```{r}
runif(10, 3, 5)
```

  - calculăm densitatea unei variabile aleatoare repartizate uniform pe $[a, b]$ în diferite puncte
  
```{r}
dunif(c(3.1, 3.7, 3.95, 4.86), 3, 5)
```

  - calculăm funcția de repartiție a unei variabile repartizate uniform pe $[a,b]$ pentru diferite valori
  
```{r}
punif(c(3.1, 3.7, 3.95, 4.86), 3, 5)
```

```{block, type = "rmdexercise"}
Fie $X$ o variabilă aleatoare repartizată uniform pe $[2,7]$. Determinați:

\begin{itemize}
  \item[a)] $\mathbb{P}(X\in\{1,2,3,4,5,6,7\})$
  \item[b)] $\mathbb{P}(X<3)$ și $\mathbb{P}(X\leq 3)$
  \item[c)] $\mathbb{P}(X\leq 3 \cup X>4)$
  \item[d)] Generați $250$ de observații din repartiția dată, trasați histograma acestora și suprapuneți densitatea repartiției date (vezi figura de mai jos).
\end{itemize}

```

```{r, echo=FALSE, out.width=dimplot}
# Uniforma
x = runif(250, 2, 7)

par(fig = c(0, 1, 0, 0.45))
boxplot(x, horizontal=T, bty="n", xlab="X",
        col = "grey80",
        ylim = c(0, 9))

par(fig = c(0, 1, 0.25, 1), new = T)
hist(x, 
     probability = TRUE, 
     breaks = seq(0, 9, by = 0.5), 
     xlim = c(0, 9),
     col = "grey80",
     main = "Repartitia uniforma pe [2,7]",
     xlab = "",
     ylab = "Densitatea")

lines(seq(0, 9, length.out = 250),
      dunif(seq(0, 9, length.out = 250), 2, 7), 
      type = "l", 
      col = myred, lty = 2, lwd = 2)
rug(x)

```

```{block, type = "rmdexercise"}
Dacă $X$ o variabilă aleatoare repartizată uniform pe $[a,b]$ și $[c,d]\subset [a,b]$ este un subinterval, atunci repartiția condiționată a lui $X$ la $X\in [c,d]$  este $\mathcal{U}[c,d]$.


```

# Repartiția Normală

Spunem că o variabilă aleatoare $X$ este repartizată *normal* sau *Gaussian* de medie $\mu$ și varianță $\sigma^2$, și se notează cu $X\sim\mathcal{N}(\mu, \sigma^2)$, dacă densitatea ei are forma 

$$
  f_X(x) \left(\overset{not}{=} \varphi(x)\right) = \frac{1}{\sqrt{2\pi}\sigma}e^{-\frac{(x-\mu)^2}{2\sigma^2}}, \quad x\in\mathbb{R}.
$$

```{r, echo=FALSE, out.width=dimplot}
u = seq(-3,3,by=.01)

plot(u,dnorm(u),type="l", axes=FALSE,
     xlab="", ylab="", col="white",
     main = TeX("Densitatea repartitiei normale $N(\\mu,\\sigma^2)$"))

axis(1, labels = F, tcl = 0)

I = which((u<=1))

polygon(c(u[I],rev(u[I])),c(dnorm(u)[I],rep(0,length(I))),
        col=col_fill, border=NA)

lines(u,dnorm(u), lwd=3, col=col_border)
segments(0, 0, 0, dnorm(0), lty = 3, col = myred)

# text(-1.5, dnorm(-1.75)+.3, TeX("$X\\sim N(\\mu,\\sigma^2)$"), cex = 1.5)
text(1.8, dnorm(1.75)+.2, TeX("$P(X\\leq a)=\\int_{-\\infty}^a \\varphi(t)dt$"), cex = 1)
arrows(1.85, dnorm(1.75)+.15, 0.5, 0.12,
       length = 0.15, angle = 20, lty = 2)

axis(side = 1, at = c(0, 1), 
     labels = c(TeX("$\\mu$"), "a"), 
     font = 2)
```

Funcția de repartiție a unei variabile $X\sim\mathcal{N}(\mu, \sigma^2)$ este dată de 

$$
  F_X(x) \left(\overset{not}{=} \Phi(x)\right) = \int_{-\infty}^{x}\varphi(t)\,dt = \frac{1}{\sqrt{2\pi}\sigma}\int_{-\infty}^{x}e^{-\frac{(t-\mu)^2}{2\sigma^2}}\,dt.
$$

Pentru funcția de repartiție nu avem o formulă explicită de calcul, ea poate fi aproximată cu ajutorul descompunerii în serie. În cazul variabilelor *normale standard* ($X\sim\mathcal{N}(0,1)$) avem proprietățile

  a) $\Phi(x) = 1-\Phi(-x)$ pentru toate valorile $x\in\mathbb{R}$
  b) $1-\Phi(a)\leq\frac{1}{2}e^{-\frac{a^2}{2}}$ pentru $a>0$^[Pentru mai multe astfel de inegalități se poate consulta cartea (capitolul 2): Lin, Z. și Bai, Z. *Probability Inequalities*, Springer, 2010.]


```{r, echo=FALSE, out.width=dimplot}
a = seq(-3, 3, by=.001)

plot(a, pnorm(a),type="l",  
     bty = "n", axes = FALSE,
     xlab="", ylab=TeX("$\\Phi(x)$"), col="white",
     main = TeX("Functia de repartitie a normalei $N(\\mu,\\sigma^2)$"))

axis(1, labels = F, tcl = 0, 
     col = "grey20")

axis(2, labels = F, tcl = 0,
     col = "grey20")

lines(a, pnorm(a), lwd=3, col=col_border)

# text(2, 0.8, TeX("$\\Phi(x)$"), cex = 1.5)

z1 = 0.65
z2 = 0.4

segments(-3.5, z1, qnorm(z1), z1, 
         lty = 2)
segments(qnorm(z1), z1, qnorm(z1), -0.5,  
         lty = 2)

segments(-3.5, z2, qnorm(z2), z2, 
         lty = 2)
segments(qnorm(z2), z2, qnorm(z2), -0.5,  
         lty = 2)

text(-1.5, (z1+z2)/2, TeX("$P(z_{1}\\leq X\\leq z_{2}) = \\Phi(z_{2})-\\Phi(z_{1})$"), cex = 1)

arrows(-2.85, z1, -2.85, z2,
       length = 0.15, angle = 20, lty = 2, code = 3)

axis(side = 1, 
     at = c(qnorm(z2), qnorm(z1)), 
     labels = c(TeX("$z_{1}$"), TeX("$z_{2}$")), 
     font = 2)

axis(side = 2, at = c(0, 1), 
     labels = c("0", "1"),
     las = 2,
     font = 2)

```

Media și varianța variabilei aleatoare $X$ repartizate normal de parametrii $\mathcal{N}(\mu, \sigma^2)$ sunt egale cu 

$$
  \mathbb{E}[X] = \mu,\quad Var(X) = \sigma^2. 
$$
Mai mult, momentele de ordin se pot calcula cu ușurință și avem că 

$$
  \mathbb{E}[X^k] = \left\{\begin{array}{ll}
      \sigma^k (k-1)!!, & \text{$k$ este par} \\
      0, & \text{$k$ este impar}.
  \end{array}\right.
$$

Pentru o variabilă aleatoare repartizată normal, avem următoarea regulă numită și regula $68-95-99.7\%$:

```{r, type = "rmdinsight", engine = engine_block} 
Fie $X$ o variabilă aleatoare repartizată $\mathcal{N}(\mu, \sigma^2)$. Atunci 

\begin{align*}
  \mathbb{P}(|X-\mu|<\sigma) &\approx 0.68\\
  \mathbb{P}(|X-\mu|<2\sigma) &\approx 0.95\\
  \mathbb{P}(|X-\mu|<3\sigma) &\approx 0.997
\end{align*}


```

În R putem să

  - generăm observații independente din repartiția $\mathcal{N}(\mu, \sigma^2)$ (e.g. $\mu = 0$ și $\sigma^2 = 2$ - în R funcțiile `rnorm`, `dnorm`, `pnorm` și `qnorm` primesc ca parametrii media și abaterea standard, $\sigma$ **nu** varianța $\sigma^2$)
  
```{r}
rnorm(10, mean = 0, sd = sqrt(2))
```

  - calculăm densitatea unei variabile aleatoare repartizate normal $\mathcal{N}(\mu, \sigma^2)$ în diferite puncte
  
```{r}
dnorm(seq(-2, 2, length.out = 15), mean = 3, sd = 5)
```

  - calculăm funcția de repartiție a unei variabile repartizate normal $\mathcal{N}(\mu, \sigma^2)$ pentru diferite valori
  
```{r}
pnorm(seq(-1, 1, length.out = 15), mean = 3, sd = 1)
```

  - calculăm cuantilele de ordin $\alpha\in(0,1)$ (i.e. valoarea $z_{\alpha}$ pentru care $\Phi(z_{\alpha}) = \alpha$ sau altfel spus $z_{\alpha} = \Phi^{-1}(\alpha)$)
  
```{r}
qnorm(c(0.01, 0.025, 0.05, 0.25, 0.5, 0.75, 0.95, 0.975, 0.99), mean = 0, sd = 1)
```

```{r, type = "rmdexercise", engine = engine_block}
Fie $X$ o variabilă aleatoare repartizată $\mathcal{N}(\mu, \sigma^2)$. Atunci pentru $\mu = 1$ și $\sigma = 3$ calculați:

\begin{itemize}
  \item[1)] $\mathbb{P}(\text{$X$ este par})$
  \item[2)] $\mathbb{P}(X<3.4)$ și $\mathbb{P}(X>1.3)$
  \item[3)] $\mathbb{P}(1<X<4)$ 
  \item[4)] $\mathbb{P}(X\in [2,3]\cup[3.5,5])$
  \item[5)] $\mathbb{P}(|X-3|>6)$
\end{itemize}

```

```{r, type = "rmdexercise", engine = engine_block}
Fie $X$ o variabilă aleatoare repartizată $\mathcal{N}(\mu, \sigma^2)$. Pentru $\mu = 0$ și $\sigma^2 \in \{0.2, 0.5, 1.5, 5\}$ trasați pe același grafic densitățile repartițiilor normale cu parametrii $\mathcal{N}(\mu, \sigma^2)$. Adăugați legendele corespunzătoare. Aceeași cerință pentru funcțiile de repartiție.


```

```{r, echo=FALSE, out.width=dimplot}
mu = 0
sigma_sq = c(0.2, 0.5, 1.5, 5)
sigma = sqrt(sigma_sq)

x = seq(-5, 5, length.out = 250)
cols = c(myblue, "burlywood2", "darkgoldenrod")

par(mfrow = c(1, 2))
# densitatile
plot(x, dnorm(x, mu, sigma[1]),
     xlab = "x",
     ylab = TeX("$\\varphi(x)$"),
     ylim = c(0,1),
     col = myred, 
     lwd = 2, type = "l",
     bty = "n",
     main = "Densitatea")

for (i in seq(length(sigma)-1)){
  y = dnorm(x, mu, sigma[i+1])
  
  lines(x, y, lwd = 2, 
        col = cols[i])
}

legend("topright", 
       legend = c(TeX("$\\mu = 0, \\sigma^2 = 0.2$"), 
                  TeX("$\\mu = 0, \\sigma^2 = 0.5$"),
                  TeX("$\\mu = 0, \\sigma^2 = 1.5$"),
                  TeX("$\\mu = 0, \\sigma^2 = 5$")),
       col = c(myred, myblue, "burlywood2", "darkgoldenrod"),
       lwd = c(2,2,2,2),
       bty = "n",
       cex = 0.7,
       seg.len = 1.5)

# functiile de repartitie
plot(x, pnorm(x, mu, sigma[1]),
     xlab = "x",
     ylab = TeX("$\\Phi(x)$"),
     ylim = c(0,1),
     col = myred, 
     lwd = 2, type = "l",
     bty = "n",
     main = "Functia de repartitie")

for (i in seq(length(sigma)-1)){
  y = pnorm(x, mu, sigma[i+1])
  
  lines(x, y, lwd = 2, 
        col = cols[i])
}

legend("bottomright", 
       legend = c(TeX("$\\mu = 0, \\sigma^2 = 0.2$"), 
                  TeX("$\\mu = 0, \\sigma^2 = 0.5$"),
                  TeX("$\\mu = 0, \\sigma^2 = 1.5$"),
                  TeX("$\\mu = 0, \\sigma^2 = 5$")),
       col = c(myred, myblue, "burlywood2", "darkgoldenrod"),
       lwd = c(2,2,2,2),
       bty = "n",
       cex = 0.7,
       seg.len = 1.5)
```


```{r, type = "rmdexercise", engine = engine_block}
Generați $250$ de observații din repartiția $\mathcal{N}(0, 2)$, trasați histograma acestora și suprapuneți densitatea repartiției date (vezi figura de mai jos).


```

```{r, echo=FALSE, out.width=dimplot}
# Normala
set.seed(1234)
x = rnorm(250, 0, sqrt(2))

par(fig = c(0, 1, 0, 0.45))
boxplot(x, horizontal=T, bty="n", xlab="X",
        col = "grey80",
        ylim = c(-5,5))

par(fig = c(0, 1, 0.25, 1), new = T)
hist(x, 
     probability = TRUE, 
     breaks = seq(-5, 5, by = 0.5),
     xlim = c(-5, 5),
     col = "grey80",
     main = TeX("Repartitia normala $N(0,2)$"),
     xlab = "",
     ylab = "Densitatea")

lines(seq(min(x), max(x), length.out = 250),
      dnorm(seq(min(x), max(x), length.out = 250), 0, sqrt(2)), 
      type = "l", 
      col = myred, lty = 2, lwd = 2)
rug(x)

```

```{r, type = "rmdexercise", engine = engine_block}
Fie $X$ o variabilă aleatoare repartizată normal de parametrii $\mu$ și $\sigma^2$. Ilustrați grafic pentru $\mu = 0$ și $\sigma = 1$ că are loc următoarea inegalitate: 

$$
  \left(\frac{1}{x}-\frac{1}{x^3}\right)\phi(x)<1-\Phi(x)<\frac{1}{x}\phi(x), \quad x>0.
$$

```

```{r, echo=FALSE, out.width=dimplot}
x = seq(0.05, 3, length.out = 150)

f1 = function(x){return(1/x*dnorm(x))}
f2 = function(x){return((1/x-1/x^3)*dnorm(x))}

plot(x, 1-pnorm(x),
     xlab = "x",
     ylab = TeX("$1-\\Phi(x)$"),
     ylim = c(0,1),
     col = myred, 
     lwd = 2, type = "l",
     bty = "n")

lines(x, f1(x), 
      col = "grey20",
      lwd = 2, 
      lty = 2)
lines(x, f2(x), 
      col = "grey20",
      lwd = 2, 
      lty = 2)

legend("topright", 
       legend = TeX("$1-\\Phi(x) = P(X>x)$"),
       col = myred,
       lty = 1,
       lwd = 2, 
       bty = "n")

text(0.8, f1(0.8)+0.2, TeX("$\\frac{1}{x} \\varphi(x)$"))
text(0.8, f2(1)+0.1, TeX("$\\left(\\frac{1}{x}-\\frac{1}{x^3}\\right)\\varphi(x)$"))
```


# Repartiția Log-Normală

Spune că o variabilă aleatoare $X$ este repartizată log-normal de parametrii $\mu$ și $\sigma^2$, și notăm $X\sim LN(\mu, \sigma^2)$, dacă $\ln(X)$ este repartizată normal de parametrii $\mu$ și $\sigma^2$. Cu alte cuvinte dacă $Y\sim \mathcal{N}(\mu, \sigma^2)$ atunci $X=e^Y\sim LN(\mu, \sigma^2)$. Densitatea repartiției log-normale $LN(\mu, \sigma^2)$ este 

$$
    f_X(x) = \frac{1}{x\sigma\sqrt{2\pi}}e^{-\frac{(\ln(x)-\mu)^2}{2\sigma^2}}, \quad x\in (0, +\infty).
$$

```{r, echo=FALSE, out.width=dimplot}
u = seq(0, 5, by=.01)

plot(u,dlnorm(u),type="l", axes=FALSE,
     xlab="", ylab="", col="white",
     main = TeX("Densitatea repartitiei log-normale $LN(\\mu,\\sigma^2)$"))

axis(1, labels = F, tcl = 0)

I = which((u<=1.5) & (u>=0.5))

polygon(c(u[I],rev(u[I])),c(dlnorm(u)[I],rep(0,length(I))),
        col=col_fill, border=NA)

lines(u,dlnorm(u), lwd=3, col=col_border)

text(1.8, dlnorm(1.5)+.2, TeX("$P(x_1\\leq X\\leq x_2)=\\int_{x_1}^{x_2} f(t)\\, dt$"), cex = 1)
arrows(1.8, dlnorm(1.5)+.15, 1, 0.2,
       length = 0.15, angle = 20, lty = 2)

axis(side = 1, at = c(0, 0.5, 1.5), 
     labels = c(0, TeX("$x_1$"), TeX("$x_2$")), 
     font = 2)
```

Funcția de repartiție a unei variabile aleatoare $X\sim LN(\mu, \sigma^2)$ este dată de 

$$
  F_{X}(x) = \int_{-\infty}^{x}f_X(t)\,dt = \frac{1}{\sqrt{2\pi}\sigma}\int_{-\infty}^{x}\frac{1}{t}e^{-\frac{(\ln(t)-\mu)^2}{2\sigma^2}}\,dt
$$

și, ca și în cazul repartiției normale, nu are o formulă explicită de calcul. 


```{r, echo=FALSE, out.width=dimplot}
a = seq(0, 5, by=.001)

plot(a, plnorm(a),type="l",  
     bty = "n", axes = FALSE,
     xlab="", ylab = TeX("$F(x)$"), col="white",
     main = TeX("Functia de repartitie a log-normalei $LN(\\mu,\\sigma^2)$"),
     ylim = c(0,1))

axis(1, labels = F, tcl = 0, 
     col = "grey20")

axis(2, labels = F, tcl = 0,
     col = "grey20")

lines(a, plnorm(a), lwd=3, col=col_border)

z1 = 0.65
z2 = 0.4

segments(-0.5, z1, qlnorm(z1), z1, 
         lty = 2)
segments(qlnorm(z1), z1, qlnorm(z1), -0.5,  
         lty = 2)

segments(-0.5, z2, qlnorm(z2), z2, 
         lty = 2)
segments(qlnorm(z2), z2, qlnorm(z2), -0.5,  
         lty = 2)

text(0.4, (z1+z2)/2, TeX("$P(x_{1}\\leq X\\leq x_{2})$"), cex = 0.8)

arrows(0, z1, 0, z2,
       length = 0.15, angle = 20, lty = 2, code = 3)

axis(side = 1, 
     at = c(qlnorm(z2), qlnorm(z1)), 
     labels = c(TeX("$x_{1}$"), TeX("$x_{2}$")), 
     font = 2)

axis(side = 2, at = c(0, 1), 
     labels = c("0", "1"),
     las = 2,
     font = 2)

```

Media și varianța variabilei aleatoare $X$ repartizate log-normal de parametrii $LN(\mu, \sigma^2)$ sunt egale cu

$$
  \mathbb{E}[X] = e^{\mu+\frac{\sigma^2}{2}},\quad Var(X) = \left(e^{\sigma^2}-1\right)e^{2\mu+\sigma^2}. 
$$

```{r, type = "rmdexercise", engine = engine_block}
Arătați că media și varianța unei variabile aleatoare repartizate log-normal de parametrii $\mu$ și $\sigma^2$ sunt egale cu

$$
  \mathbb{E}[X] = e^{\mu+\frac{\sigma^2}{2}},\quad Var(X) = \left(e^{\sigma^2}-1\right)e^{2\mu+\sigma^2}. 
$$


```

În R putem să

  - generăm observații independente din repartiția $LN(\mu, \sigma^2)$ (e.g. $\mu = 0$ și $\sigma^2 = 3$ - ca și în cazul repartiției normale, funcțiile `rlnorm`, `dlnorm`, `plnorm` și `qlnorm` primesc ca parametrii media și abaterea standard, $\sigma$ pentru $\ln(X)$ - variabila normală)
  
```{r}
rlnorm(15, meanlog = 0, sdlog = sqrt(3))
```

  - calculăm densitatea unei variabile aleatoare repartizate log-normal $LN(\mu, \sigma^2)$ în diferite puncte
  
```{r}
dlnorm(seq(0, 5, length.out = 20), meanlog = 3, sdlog = 5)
```

  - calculăm funcția de repartiție a unei variabile repartizate log-normal $LN(\mu, \sigma^2)$ pentru diferite valori
  
```{r}
plnorm(seq(0, 15, length.out = 25), meanlog = 3, sdlog = 1)
```

  - calculăm cuantilele de ordin $\alpha\in(0,1)$ 
  
```{r}
qlnorm(c(0.01, 0.025, 0.05, 0.25, 0.5, 0.75, 0.95, 0.975, 0.99), meanlog = 0, sdlog = 1)
```


```{r, type = "rmdexercise", engine = engine_block}
Fie $X$ o variabilă aleatoare repartizată $LN(\mu, \sigma^2)$. Pentru $\mu = 0$ și $\sigma \in \{0.25, 0.5, 1.5, 5\}$ trasați pe același grafic densitățile repartițiilor log-normale cu parametrii $LN(\mu, \sigma^2)$. Adăugați legendele corespunzătoare. Aceeași cerință pentru funcțiile de repartiție.


```

```{r, echo=FALSE, out.width=dimplot}
mu = 0
sigma = c(0.25, 0.5, 1, 1.5, 2)
# sigma = sqrt(sigma_sq)

x = seq(0, 7, length.out = 250)
cols = c(myblue, "burlywood2", "darkgoldenrod", "salmon3")

par(mfrow = c(1, 2))
# densitatile
plot(x, dlnorm(x, mu, sigma[1]),
     xlab = "x",
     ylab = TeX("$f(x)$"),
     ylim = c(0,2),
     col = myred, 
     lwd = 2, type = "l",
     bty = "n",
     main = "Densitatea")

for (i in seq(length(sigma)-1)){
  y = dlnorm(x, mu, sigma[i+1])
  
  lines(x, y, lwd = 2, 
        col = cols[i])
}

legend("topright", 
       legend = c(TeX("$\\mu = 0, \\sigma = 0.25$"), 
                  TeX("$\\mu = 0, \\sigma = 0.5$"),
                  TeX("$\\mu = 0, \\sigma = 1$"),
                  TeX("$\\mu = 0, \\sigma = 1.5$"),
                  TeX("$\\mu = 0, \\sigma = 2$")),
       col = c(myred, myblue, "burlywood2", "darkgoldenrod", "salmon3"),
       lwd = c(2,2,2,2,2),
       bty = "n",
       cex = 0.7,
       seg.len = 1.5)

# functiile de repartitie
plot(x, plnorm(x, mu, sigma[1]),
     xlab = "x",
     ylab = TeX("$F(x)$"),
     ylim = c(0,1),
     col = myred, 
     lwd = 2, type = "l",
     bty = "n",
     main = "Functia de repartitie")

for (i in seq(length(sigma)-1)){
  y = plnorm(x, mu, sigma[i+1])
  
  lines(x, y, lwd = 2, 
        col = cols[i])
}

legend("bottomright", 
       legend = c(TeX("$\\mu = 0, \\sigma = 0.25$"), 
                  TeX("$\\mu = 0, \\sigma = 0.5$"),
                  TeX("$\\mu = 0, \\sigma = 1$"),
                  TeX("$\\mu = 0, \\sigma = 1.5$"),
                  TeX("$\\mu = 0, \\sigma = 2$")),
       col = c(myred, myblue, "burlywood2", "darkgoldenrod", "salmon3"),
       lwd = c(2,2,2,2,2),
       bty = "n",
       cex = 0.7,
       seg.len = 1.5)
```


```{r, type = "rmdexercise", engine = engine_block}
Generați $500$ de observații din repartiția $LN(0, 2)$, trasați histograma acestora și suprapuneți densitatea repartiției date (vezi figura de mai jos).


```

```{r, echo=FALSE, out.width=dimplot, message=FALSE, warning=FALSE}
# Log-Normala
set.seed(1234)
x = rlnorm(500, 0, sqrt(1))

par(fig = c(0, 1, 0, 0.45))
boxplot(x, horizontal=T, bty="n", xlab="X",
        col = "grey80",
        ylim = c(0,10))

par(fig = c(0, 1, 0.25, 1), new = T)
hist(x, 
     probability = TRUE, 
     breaks = seq(0, max(x)+1, by = 0.5),
     xlim = c(0, 10),
     ylim = c(0, 0.65),
     col = "grey80",
     main = TeX("Repartitia log-normala $LN(0,1)$"),
     xlab = "",
     ylab = "Densitatea")

lines(seq(0, 10, length.out = 250),
      dlnorm(seq(0, 10, length.out = 250), 0, sqrt(1)), 
      type = "l", 
      col = myred, lty = 2, lwd = 2)
rug(x)

```

Printre fenomenele care pot fi modelate cu ajutorul repartiției log-normale se numără: cantitatea de lapte produsă de vaci, cantitatea de ploaie dintr-o perioadă dată, repartiția mărimii picăturilor de ploaie, volumul de gaz dintr-o rezervă petrolieră, etc. Pentru mai multe aplicații se poate consulta lucrarea lui Limpert, E., Stajel, W. și Abbt, M. [Log-normal Distributions across the Sciences: Keys and Clues](http://stat.ethz.ch/~stahel/lognormal/bioscience.pdf), *BioScience*, Vol. 51, Nr. 5, 2001. 

# Repartiția Exponențială

Spunem că o variabilă aleatoare $X$ este repartizată *exponențial* de parametru $\lambda$, și se notează cu $X\sim\mathcal{E}(\lambda)$, dacă densitatea ei are forma 

$$
  f_X(x) = \lambda e^{-\lambda x}\mathbb{1}_{\mathbb{R}_+}(x),\quad \forall x\in\mathbb{R}.
$$

```{r, echo=FALSE, out.width=dimplot}
u = seq(0, 5, by=.01)

plot(u,dexp(u),type="l", axes=FALSE,
     xlab="", ylab="", col="white",
     main = TeX("Densitatea repartitiei exponentiale $E(\\lambda)$"))

axis(1, labels = F, tcl = 0)

I = which((u<=1.5) & (u>=0.5))

polygon(c(u[I],rev(u[I])),c(dexp(u)[I],rep(0,length(I))),
        col=col_fill, border=NA)

lines(u,dexp(u), lwd=3, col=col_border)

text(1.8, dlnorm(1.5)+.2, TeX("$P(x_1\\leq X\\leq x_2)=\\int_{x_1}^{x_2} \\lambda e^{-\\lambda t}\\, dt$"), cex = 1)
arrows(1.8, dlnorm(1.5)+.15, 1, 0.2,
       length = 0.15, angle = 20, lty = 2)

axis(side = 1, at = c(0, 0.5, 1.5), 
     labels = c(0, TeX("$x_1$"), TeX("$x_2$")), 
     font = 2)
```

Funcția de repartiție a unei variabile aleatoare $X\sim \mathcal{E}(\lambda)$ este dată de 

$$
  F_{X}(x) = 1 - e^{-\lambda x}\mathbb{1}_{\mathbb{R}_+}(x), \quad x\in \mathbb{R}.
$$

```{r, echo=FALSE, out.width=dimplot}
a = seq(0, 5, by=.001)

plot(a, pexp(a),type="l",  
     bty = "n", axes = FALSE,
     xlab="", ylab = TeX("$F(x)$"), col="white",
     main = TeX("Functia de repartitie a exponentialei $E(\\lambda)$"),
     ylim = c(0,1))

axis(1, labels = F, tcl = 0, 
     col = "grey20")

axis(2, labels = F, tcl = 0,
     col = "grey20")

lines(a, pexp(a), lwd=3, col=col_border)

z1 = 0.75
z2 = 0.4

segments(-0.5, z1, qexp(z1), z1, 
         lty = 2)
segments(qexp(z1), z1, qexp(z1), -0.5,  
         lty = 2)

segments(-0.5, z2, qexp(z2), z2, 
         lty = 2)
segments(qexp(z2), z2, qexp(z2), -0.5,  
         lty = 2)

text(0.4, (z1+z2)/2, TeX("$P(x_{1}\\leq X\\leq x_{2})$"), cex = 0.8)

arrows(0, z1, 0, z2,
       length = 0.15, angle = 20, lty = 2, code = 3)

axis(side = 1, 
     at = c(qexp(z2), qexp(z1)), 
     labels = c(TeX("$x_{1}$"), TeX("$x_{2}$")), 
     font = 2)

axis(side = 2, at = c(0, 1), 
     labels = c("0", "1"),
     las = 2,
     font = 2)

```

Media și varianța variabilei aleatoare $X$ repartizate exponențial de parametru $\lambda$ sunt egale cu

$$
  \mathbb{E}[X] = \frac{1}{\lambda},\quad Var(X) =  \frac{1}{\lambda^2}. 
$$

```{r, type = "rmdexercise", engine = engine_block}
Arătați că momentul de ordin $k$, $k\geq 1$, al unei variabile aleatoare repartizate exponențial $X\sim\mathcal{E}(\lambda)$ este egal cu

$$
  \mathbb{E}[X^k] = \frac{k!}{\lambda^k}. 
$$


```

```{r, type = "rmdinsight", engine = engine_block} 
Fie $X$ o variabilă repartizată exponențial de parametru $\lambda$. Atunci are loc următoarea proprietate numită și *lipsa de memorie*: 

$$
      \mathbb{P}(X>s+t|X>s) = \mathbb{P}(X>t),\quad \forall s,t \geq 0. 
$$
  
Mai mult, dacă o variabilă aleatoare continuă^[Pentru cazul discret avem variabila repartizată Geometric.] $X$ verifică proprietatea de mai sus atunci ea este repartizată exponențial.



```

Variabilele aleatoare repartizate exponențial sunt utilizate în modelarea fenomenelor care se desfășoară în timp continuu și care satisfac (aproximativ) proprietatea lipsei de memorie: de exemplu timpul de așteptare la un ghișeu, durata de viață a unui bec sau timpul până la următoarea convorbire telefonică.

În R putem să

  - generăm observații independente din repartiția $\mathcal{E}(\lambda)$ (e.g. $\lambda = 5$)
  
```{r}
rexp(15, rate = 5)
```

  - calculăm densitatea unei variabile aleatoare repartizate exponențial $\mathcal{E}(\lambda)$ în diferite puncte
  
```{r}
dexp(seq(0, 5, length.out = 20), rate = 5)
```

  - calculăm funcția de repartiție a unei variabile repartizate exponențial $\mathcal{E}(\lambda)$ pentru diferite valori
  
```{r}
pexp(seq(0, 5, length.out = 15), rate = 5)
```

  - calculăm cuantilele de ordin $\alpha\in(0,1)$ 
  
```{r}
qexp(c(0.01, 0.025, 0.05, 0.25, 0.5, 0.75, 0.95, 0.975, 0.99), rate = 5)
```

```{r, type = "rmdexercise", engine = engine_block}
Fie $X$ o variabilă aleatoare repartizată $\mathcal{E}(\lambda)$. Pentru $\lambda \in \{0.5, 1.5, 5\}$ trasați pe același grafic densitățile repartițiilor exponențiale de parametru $\lambda$. Adăugați legendele corespunzătoare. Aceeași cerință pentru funcțiile de repartiție.


```

```{r, echo=FALSE, out.width=dimplot}
mu = 0
lambda = c(0.5, 1.5, 5)
# sigma = sqrt(sigma_sq)

x = seq(0, 5, length.out = 250)
cols = c(myblue, "burlywood2", "darkgoldenrod")

par(mfrow = c(1, 2))
# densitatile
plot(x, dexp(x, lambda[1]),
     xlab = "x",
     ylab = TeX("$f(x)$"),
     ylim = c(0,2),
     col = myred, 
     lwd = 2, type = "l",
     bty = "n",
     main = "Densitatea")

for (i in seq(length(lambda)-1)){
  y = dexp(x, lambda[i+1])
  
  lines(x, y, lwd = 2, 
        col = cols[i])
}

legend("topright", 
       legend = c(TeX("$\\lambda = 0.5$"), 
                  TeX("$\\lambda = 1.5$"),
                  TeX("$\\lambda = 5$")),
       col = c(myred, myblue, "burlywood2"),
       lwd = c(2,2,2),
       bty = "n",
       cex = 0.7,
       seg.len = 1.5)

# functiile de repartitie
plot(x, pexp(x, lambda[1]),
     xlab = "x",
     ylab = TeX("$F(x)$"),
     ylim = c(0,1),
     col = myred, 
     lwd = 2, type = "l",
     bty = "n",
     main = "Functia de repartitie")

for (i in seq(length(lambda)-1)){
  y = pexp(x, lambda[i+1])
  
  lines(x, y, lwd = 2, 
        col = cols[i])
}

legend("bottomright", 
       legend = c(TeX("$\\lambda = 0.5$"), 
                  TeX("$\\lambda = 1.5$"),
                  TeX("$\\lambda = 5$")),
       col = c(myred, myblue, "burlywood2"),
       lwd = c(2,2,2),
       bty = "n",
       cex = 0.7,
       seg.len = 1.5)
```

```{r, type = "rmdexercise", engine = engine_block}
Folosind rezultatul de universalitate de la repartiția uniformă, descrieți o procedură prin care puteți simula o variabilă aleatoare repartizată exponențial $\mathcal{E}(\lambda)$ și construiți o funcție care permite generarea de $n$ observații independente dintr-o variabilă repartizată $X\sim \mathcal{E}(\lambda)$. 

```

```{r, echo=FALSE, out.width=dimplot, message=FALSE, warning=FALSE}
# Exponentiala
gen_Exp = function(n, lambda){
  u = runif(n)
  return(-log(u)/lambda)
}

```

```{r, type = "rmdexercise", engine = engine_block}
Generați $250$ de observații din repartiția $\mathcal{E}(3)$, trasați histograma acestora și suprapuneți densitatea repartiției date (vezi figura de mai jos).


```

```{r, echo=FALSE, out.width=dimplot, message=FALSE, warning=FALSE}
# Exponentiala
set.seed(1234)
x = rexp(250, 3)

par(fig = c(0, 1, 0, 0.45))
boxplot(x, horizontal=T, bty="n", xlab="X",
        col = "grey80",
        ylim = c(0,5))

par(fig = c(0, 1, 0.25, 1), new = T)
hist(x, 
     probability = TRUE, 
     breaks = seq(0, 5, by = 0.25),
     xlim = c(0, 5),
     ylim = c(0, 2.5),
     col = "grey80",
     main = TeX("Repartitia exponentiala $E(3)$"),
     xlab = "",
     ylab = "Densitatea")

lines(seq(0, 5, length.out = 250),
      dexp(seq(0, 5, length.out = 250), 3), 
      type = "l", 
      col = myred, lty = 2, lwd = 2)
rug(x)

```


# Repartiția Cauchy

Spunem că o variabilă aleatoare $X$ este repartizată *Cauchy* de parametrii $(0, 1)$, și se notează cu $X\sim C(0,1)$, dacă densitatea ei are forma 

$$
  f_X(x) = \frac{1}{\pi} \frac{1}{1+x^2},\quad \forall x\in\mathbb{R}.
$$

Observăm că graficul densității repartiției Cauchy este asemănător cu cel al repartiției normale. Parametrul $M = 0$ reprezintă mediana (de fapt $\mathbb{P}(X\leq 0) = \mathbb{P}(X\geq 0) = \frac{1}{2}$) variabilei aleatoare $X$ și nu media iar prima și a treia cuartilă sunt $Q_1 = -1$ și respectiv $Q_3=1$ (avem $\mathbb{P}(X\leq -1) = \mathbb{P}(X\geq 1) = \frac{1}{4}$).  

```{r, echo=FALSE, out.width=dimplot}
u = seq(-5, 5, by=.01)

plot(u,dcauchy(u),type="l", axes=FALSE,
     xlab="", ylab="", col="white",
     main = TeX("Densitatea repartitiei Cauchy"))

axis(1, labels = F, tcl = 0)

I = which((u<=1.5) & (u>=0.5))

polygon(c(u[I],rev(u[I])),c(dcauchy(u)[I],rep(0,length(I))),
        col=col_fill, border=NA)

lines(u,dcauchy(u), lwd=3, col=col_border)

text(2.8, dcauchy(1.5)+.07, 
     TeX("$P(x_1\\leq X\\leq x_2)=\\int_{x_1}^{x_2} \\frac{1}{\\pi(1+t^2)} \\, dt$"), 
     cex = 0.8)
arrows(2.5, dcauchy(1.5)+.05, 1, 0.05,
       length = 0.15, angle = 20, lty = 2)

axis(side = 1, at = c(0, 0.5, 1.5), 
     labels = c(0, TeX("$x_1$"), TeX("$x_2$")), 
     font = 2)
```

Funcția de repartiție a unei variabile aleatoare $X\sim C(0,1)$ este dată de 

$$
  F_{X}(x) = \frac{1}{2} + \frac{1}{\pi}\arctan(x), \quad x\in \mathbb{R}.
$$

```{r, echo=FALSE, out.width=dimplot}
a = seq(-5, 5, by=.001)

plot(a, pcauchy(a),type="l",  
     bty = "n", axes = FALSE,
     xlab="", ylab = TeX("$F(x)$"), col="white",
     main = TeX("Functia de repartitie a repartitiei Cauchy"),
     ylim = c(0,1))

axis(1, labels = F, tcl = 0, 
     col = "grey20")

axis(2, labels = F, tcl = 0,
     col = "grey20")

lines(a, pcauchy(a), lwd=3, col=col_border)

z1 = 0.75
z2 = 0.4

segments(-5.5, z1, qcauchy(z1), z1, 
         lty = 2)
segments(qcauchy(z1), z1, qcauchy(z1), -0.5,  
         lty = 2)

segments(-5.5, z2, qcauchy(z2), z2, 
         lty = 2)
segments(qcauchy(z2), z2, qcauchy(z2), -0.5,  
         lty = 2)

text(-3.7, (z1+z2)/2, TeX("$P(x_{1}\\leq X\\leq x_{2})$"), cex = 0.8)

arrows(-4.7, z1, -4.7, z2,
       length = 0.15, angle = 20, lty = 2, code = 3)

axis(side = 1, 
     at = c(qcauchy(z2), qcauchy(z1)), 
     labels = c(TeX("$x_{1}$"), TeX("$x_{2}$")), 
     font = 2)

axis(side = 2, at = c(0, 1), 
     labels = c("0", "1"),
     las = 2,
     font = 2)

```

Media și varianța variabilei aleatoare $X\sim C(0,1)$ **nu există**. 

```{r, type = "rmdexercise", engine = engine_block}
Arătați că o variabilă aleatoare repartizată Cauchy $C(0,1)$ nu are medie.  


```

Fie $Y\sim C(0,1)$ și $\alpha, \beta\in\mathbb{R}$ cu $\beta>0$. Spunem că variabila aleatoare $X = \alpha + \beta Y$ este repartizată Cauchy de parametrii $(\alpha, \beta)$, $X\sim C(\alpha, \beta)$. Densitatea ei este 

$$
  f_X(x) = \frac{1}{\pi\beta} \frac{1}{1+\left(\frac{x-\alpha}{\beta}\right)^2},\quad \forall x\in\mathbb{R}.
$$

Parametrii $\alpha$ și $\beta$ se interpretează în modul următor: $M = \alpha$ este mediana lui $X$ iar $Q_1 = \alpha-\beta$ și $Q_3 = \alpha + \beta$ reprezintă prima și a treia cuartilă.  

În R putem să

  - generăm observații independente din repartiția Cauchy $C(\alpha, \beta)$ (e.g. $\alpha = 0$, $\beta = 2$)
  
```{r}
rcauchy(15, location = 0, scale = 2)
```

  - calculăm densitatea unei variabile aleatoare repartizate Cauchy $C(\alpha, \beta)$ în diferite puncte
  
```{r}
dcauchy(seq(-5, 5, length.out = 20), location = 1, scale = 3)
```

  - calculăm funcția de repartiție a unei variabile repartizate Cauchy $C(\alpha, \beta)$ pentru diferite valori
  
```{r}
pcauchy(seq(-5, 5, length.out = 15), location = 1, scale = 3)
```

  - calculăm cuantilele de ordin $p\in(0,1)$ 
  
```{r}
qcauchy(c(0.01, 0.025, 0.05, 0.25, 0.5, 0.75, 0.95, 0.975, 0.99), location = 1, scale = 3)
```

```{r, type = "rmdexercise", engine = engine_block}
Generați $2500$ de observații din repartiția Cauchy, trasați histograma acestora și suprapuneți densitatea repartiției date pentru intervalul $[-5,5]$ (vezi figura de mai jos).


```

```{r, echo=FALSE, out.width=dimplot, message=FALSE, warning=FALSE}
# Cauchy
# set.seed(1234)
x = rcauchy(2500)

par(fig = c(0, 1, 0, 0.45))
boxplot(x, horizontal=T, bty="n", xlab="X",
        col = "grey80",
        ylim = c(-5,5))

par(fig = c(0, 1, 0.25, 1), new = T)
hist(x, 
     probability = TRUE, 
     breaks = seq(min(x)-0.5, max(x)+0.5, by = 0.5),
     xlim = c(-5, 5),
     ylim = c(0, 0.5),
     col = "grey80",
     main = TeX("Repartitia Cauchy"),
     xlab = "",
     ylab = "Densitatea")

lines(seq(-5, 5, length.out = 250),
      dcauchy(seq(-5, 5, length.out = 250)), 
      type = "l", 
      col = myred, lty = 2, lwd = 2)
rug(x)

```

```{r, type = "rmdexercise", engine = engine_block}
Fie $X$ și $Y$ două variabile aleatoare independente repartizate $\mathcal{N}(0,1)$. Arătați că variabila aleatoare $\frac{X}{Y}$ este repartizată Cauchy $C(0,1)$.


```

```{r, type = "rmdexercise", engine = engine_block}
Fie $X$ o variabilă aleatoare repartizată Cauchy $C(\alpha, \beta)$. Pentru fiecare pereche de parametrii $(\alpha, \beta)$ din mulțimea $\{(0,0.5), (0, 1), (0, 2), (-1, 1.5), (-2, 1)\}$ trasați pe același grafic densitățile repartițiilor Cauchy cu parametrii $(\alpha, \beta)$. Adăugați legendele corespunzătoare. Aceeași cerință pentru funcțiile de repartiție.


```

```{r, echo=FALSE, out.width=dimplot}
pars = matrix(c(0, 0.5, 0, 1, 0, 2, -1, 1.5, -2, 1), 
              ncol = 2, byrow = TRUE)

x = seq(-5, 5, length.out = 250)

set.seed(4321)
cols = sample(colors(), nrow(pars))

par(mfrow = c(1, 2))
# densitatile
plot(x, dcauchy(x, location = pars[1, 1], scale = pars[1, 2]),
     xlab = "x",
     ylab = TeX("$f(x)$"),
     ylim = c(0,1),
     col = myred, 
     lwd = 2, type = "l",
     bty = "n",
     main = "Densitatea")

for (i in seq(nrow(pars)-1)){
  alpha = pars[i+1, 1]
  beta = pars[i+1, 2]
    
  y = dcauchy(x, location = alpha, scale = beta)
  
  lines(x, y, lwd = 2, 
        col = cols[i])
}

legend("topright", 
       legend = TeX(paste0("$\\alpha = ", pars[,1], ", \\beta = ", pars[,2], "$")),
       col = cols,
       lwd = rep(2, nrow(pars)),
       bty = "n",
       cex = 0.7,
       seg.len = 1.5)

# functiile de repartitie
plot(x, pcauchy(x, location = pars[1, 1], scale = pars[1, 2]),
     xlab = "x",
     ylab = TeX("$F(x)$"),
     ylim = c(0,1),
     col = myred, 
     lwd = 2, type = "l",
     bty = "n",
     main = "Functia de repartitie")

for (i in seq(nrow(pars)-1)){
  alpha = pars[i+1, 1]
  beta = pars[i+1, 2]
  
  y = pcauchy(x, location = alpha, scale = beta)
  
  lines(x, y, lwd = 2, 
        col = cols[i])
}

legend("bottomright", 
       legend = TeX(paste0("$\\alpha = ", pars[,1], ", \\beta = ", pars[,2], "$")),
       col = cols,
       lwd = rep(2, nrow(pars)),
       bty = "n",
       cex = 0.7,
       seg.len = 1.5)
```

```{r, type = "rmdexercise", engine = engine_block}
Folosind rezultatul de universalitate de la repartiția uniformă, descrieți o procedură prin care puteți simula o variabilă aleatoare repartizată Cauchy $C(0,1)$ și construiți o funcție care permite generarea de $n$ observații independente dintr-o variabilă repartizată $X\sim C(\alpha, \beta)$. Verificați pentru parametrii $\alpha = 3$ și $\beta = 5$ (a se vedea figura de mai jos).


```

```{r, echo=FALSE}
# functia 
gen_Cauchy = function(n, alpha, beta){
  x = pi*runif(n) - pi/2
  y = alpha + beta*tan(x)
  
  return(y)
}

# verificare
x = gen_Cauchy(2500, 3, 5)

par(fig = c(0, 1, 0, 0.45))
boxplot(x, horizontal=T, bty="n", xlab="X",
        col = "grey80",
        ylim = c(-10,16))

par(fig = c(0, 1, 0.25, 1), new = T)
hist(x, 
     probability = TRUE, 
     breaks = seq(min(x)-0.5, max(x)+0.5, by = 0.5),
     xlim = c(-10, 16),
     ylim = c(0, 0.1),
     col = "grey80",
     main = TeX("Repartitia Cauchy $C(3, 5)$"),
     xlab = "",
     ylab = "Densitatea")

lines(seq(-10, 16, length.out = 450),
      dcauchy(seq(-10, 16, length.out = 450), 3, 5), 
      type = "l", 
      col = myred, lty = 2, lwd = 2)
rug(x)
```

# Repartiția Gama

Spunem că o variabilă aleatoare $X$ este repartizată *Gama* de parametrii $(\alpha, \beta)$, cu $\alpha, \beta > 0$, și se notează cu $X\sim \Gamma(\alpha,\beta)$, dacă densitatea ei are forma 

$$
  f_X(x) = \frac{\beta^{\alpha}}{\Gamma(\alpha)} x^{\alpha-1} e^{-\beta x},\quad \forall x>0.
$$

unde $\Gamma(\alpha)$ este funcția (Gama, numită și integrală Euler de al doilea tip) definită prin 

$$
  \Gamma(\alpha) = \int_{0}^{\infty}x^{\alpha-1} e^{- x}\,dx,\quad \forall \alpha>0.
$$

```{r, echo=FALSE, out.width=dimplot}
# shape - rate parametrization
alpha = 2
beta = 2
  
u = seq(0, 5, by=.01)

plot(u,dgamma(u, shape = alpha, rate = beta),type="l", axes=FALSE,
     xlab="", ylab="", col="white",
     main = TeX("Densitatea repartitiei $\\Gamma(\\alpha, \\beta)$"))

axis(1, labels = F, tcl = 0)

I = which((u<=1.5) & (u>=0.5))

polygon(c(u[I],rev(u[I])),c(dgamma(u, shape = alpha, rate = beta)[I],rep(0,length(I))),
        col=col_fill, border=NA)

lines(u,dgamma(u, shape = alpha, rate = beta), lwd=3, col=col_border)

text(2.3, dgamma(1.5, shape = alpha, rate = beta)+.2, TeX("$P(x_1\\leq X\\leq x_2)=\\int_{x_1}^{x_2} \\frac{\\beta^{\\alpha}}{\\Gamma(\\alpha)}t^{\\alpha-1} e^{-\\beta t}\\, dt$"), cex = 1)
arrows(1.8, dgamma(1.5, shape = alpha, rate = beta)+.15, 1, 0.2,
       length = 0.15, angle = 20, lty = 2)

axis(side = 1, at = c(0, 0.5, 1.5), 
     labels = c(0, TeX("$x_1$"), TeX("$x_2$")), 
     font = 2)

```


```{r, type = "rmdexercise", engine = engine_block}
Arătați că funcția $\Gamma(\alpha)$ verifică^[Pentru mai multe proprietăți puteți consulta lucrarea lui E. Artin [The Gamma Function](http://plouffe.fr/simon/math/Artin%20E.%20The%20Gamma%20Function%20(1931)(23s).pdf)]:

\begin{itemize}
  \item[1)] $\Gamma(1)=1$
  \item[2)] $\Gamma(\alpha+1) = \alpha\Gamma(\alpha), \quad \forall \alpha>0$
  \item[3)] $\Gamma(\alpha) = \beta^{\alpha}\int_{0}^{\infty}x^{\alpha-1} e^{- \beta x}\,dx,\quad \forall \alpha, \beta>0$
  \item[4)] $\Gamma(n) = (n-1)!,\quad n = 1,2,\cdots$
  \item[5)] $\Gamma(1/2) = \sqrt{\pi}$
\end{itemize}


```

Funcția de repartiție a unei variabile aleatoare $X\sim \Gamma(\alpha, \beta)$ este dată de 

$$
  F_{X}(x) = \int_{-\infty}^{x}f_X(t)\,dt = \frac{\beta^{\alpha}}{\Gamma(\alpha)}\int_{-\infty}^{x} t^{\alpha-1} e^{-\beta t}\,dt
$$

și nu are o formulă explicită de calcul. 

```{r, echo=FALSE, out.width=dimplot}
# shape - rate parametrization
alpha = 2
beta = 2

a = seq(0, 5, by=.001)

plot(a, pgamma(a, shape = alpha, rate = beta),type="l",  
     bty = "n", axes = FALSE,
     xlab="", ylab = TeX("$F(x)$"), col="white",
     main = TeX("Functia de repartitie a repartitiei $\\Gamma(\\alpha,\\beta)$"),
     ylim = c(0,1))

axis(1, labels = F, tcl = 0, 
     col = "grey20")

axis(2, labels = F, tcl = 0,
     col = "grey20")

lines(a, pgamma(a, shape = alpha, rate = beta), lwd=3, col=col_border)

z1 = 0.75
z2 = 0.4

segments(-0.5, z1, qgamma(z1, shape = alpha, rate = beta), z1, 
         lty = 2)
segments(qgamma(z1, shape = alpha, rate = beta), z1, qgamma(z1, shape = alpha, rate = beta), -0.5,  
         lty = 2)

segments(-0.5, z2, qgamma(z2, shape = alpha, rate = beta), z2, 
         lty = 2)
segments(qgamma(z2, shape = alpha, rate = beta), z2, qgamma(z2, shape = alpha, rate = beta), -0.5,  
         lty = 2)

text(0.4, (z1+z2)/2, TeX("$P(x_{1}\\leq X\\leq x_{2})$"), cex = 0.8)

arrows(0, z1, 0, z2,
       length = 0.15, angle = 20, lty = 2, code = 3)

axis(side = 1, 
     at = c(qgamma(z2, shape = alpha, rate = beta), qgamma(z1, shape = alpha, rate = beta)), 
     labels = c(TeX("$x_{1}$"), TeX("$x_{2}$")), 
     font = 2)

axis(side = 2, at = c(0, 1), 
     labels = c("0", "1"),
     las = 2,
     font = 2)

```

Observăm că repartiția $\Gamma(1, \lambda)$ coincide cu repartiția $\mathcal{E}(\lambda)$. 

Media și varianța variabilei aleatoare $X$ repartizate Gama de parametrii $\Gamma(\alpha, \beta)$ sunt egale cu

$$
  \mathbb{E}[X] = \frac{\alpha}{\beta},\quad Var(X) = \frac{\alpha}{\beta^2}.
$$



```{r, type = "rmdexercise", engine = engine_block}
Arătați că media și varianța unei variabile aleatoare repartizate Gama de parametrii $\alpha$ și $\beta$ sunt egale cu

$$
  \mathbb{E}[X] = \frac{\alpha}{\beta},\quad Var(X) = \frac{\alpha}{\beta^2}. 
$$


```

În R putem să

  - generăm observații independente din repartiția $\Gamma(\alpha, \beta)$ (e.g. $\alpha = 2$, $\beta = 2$)
  
```{r}
rgamma(15, shape = 2, rate = 2)
```

  - calculăm densitatea unei variabile aleatoare repartizate $\Gamma(\alpha, \beta)$ în diferite puncte
  
```{r}
dgamma(seq(0, 5, length.out = 20), shape = 1, rate = 3)
```

  - calculăm funcția de repartiție a unei variabile repartizate $\Gamma(\alpha, \beta)$ pentru diferite valori
  
```{r}
pgamma(seq(0, 5, length.out = 15), shape = 1, rate = 3)
```

  - calculăm cuantilele de ordin $p\in(0,1)$ 
  
```{r}
qgamma(c(0.01, 0.025, 0.05, 0.25, 0.5, 0.75, 0.95, 0.975, 0.99), shape = 1, rate = 3)
```

```{r, type = "rmdexercise", engine = engine_block}
Fie $X$ o variabilă aleatoare repartizată $\Gamma(\alpha, \beta)$. Pentru fiecare pereche de parametrii $(\alpha, \beta)$ din mulțimea $\{(1,0.5), (2, 0.5), (3, 0.5), (5, 1), (9, 0.5), (7.5, 1), (0.5, 1) \}$ trasați pe același grafic densitățile repartițiilor Gama cu parametrii $(\alpha, \beta)$. Adăugați legendele corespunzătoare. Aceeași cerință pentru funcțiile de repartiție.


```

```{r, echo=FALSE, out.width=dimplot}
pars = matrix(c(1, 0.5, 2, 0.5, 3, 0.5, 5, 1, 9, 0.5, 7.5, 1, 0.5, 1), 
              ncol = 2, byrow = TRUE)

x = seq(0, 20, length.out = 250)

set.seed(1234)
cols = sample(colors(), nrow(pars))

par(mfrow = c(1, 2))
# densitatile
plot(x, dgamma(x, shape = pars[1, 1], rate = pars[1, 2]),
     xlab = "x",
     ylab = TeX("$f(x)$"),
     ylim = c(0,1),
     col = myred, 
     lwd = 2, type = "l",
     bty = "n",
     main = "Densitatea")

for (i in seq(nrow(pars)-1)){
  alpha = pars[i+1, 1]
  beta = pars[i+1, 2]
    
  y = dgamma(x, shape = alpha, rate = beta)
  
  lines(x, y, lwd = 2, 
        col = cols[i])
}

legend("topright", 
       legend = TeX(paste0("$\\alpha = ", pars[,1], ", \\beta = ", pars[,2], "$")),
       col = cols,
       lwd = rep(2, nrow(pars)),
       bty = "n",
       cex = 0.7,
       seg.len = 1.5)

# functiile de repartitie
plot(x, pgamma(x, shape = pars[1, 1], rate = pars[1, 2]),
     xlab = "x",
     ylab = TeX("$F(x)$"),
     ylim = c(0,1),
     col = myred, 
     lwd = 2, type = "l",
     bty = "n",
     main = "Functia de repartitie")

for (i in seq(nrow(pars)-1)){
  alpha = pars[i+1, 1]
  beta = pars[i+1, 2]
  
  y = pgamma(x, shape = alpha, rate = beta)
  
  lines(x, y, lwd = 2, 
        col = cols[i])
}

legend("bottomright", 
       legend = TeX(paste0("$\\alpha = ", pars[,1], ", \\beta = ", pars[,2], "$")),
       col = cols,
       lwd = rep(2, nrow(pars)),
       bty = "n",
       cex = 0.7,
       seg.len = 1.5)
```

```{r, type = "rmdexercise", engine = engine_block}
Generați $250$ de observații din repartiția $\Gamma(9,2)$, trasați histograma acestora și suprapuneți densitatea repartiției date (vezi figura de mai jos).


```

```{r, echo=FALSE, out.width=dimplot, message=FALSE, warning=FALSE}
# shape - rate parametrization
alpha = 9
beta = 2

set.seed(1234)
x = rgamma(250, shape = alpha, rate = beta)

par(fig = c(0, 1, 0, 0.45))
boxplot(x, horizontal=T, bty="n", xlab="X",
        col = "grey80",
        ylim = c(0,10))

par(fig = c(0, 1, 0.25, 1), new = T)
hist(x, 
     probability = TRUE, 
     # breaks = seq(0, 5, by = 0.25),
     xlim = c(0, 10),
     ylim = c(0, 0.5),
     col = "grey80",
     main = TeX("Repartitia $\\Gamma(9,2)$"),
     xlab = "",
     ylab = "Densitatea")

lines(seq(0, 10, length.out = 250),
      dgamma(seq(0, 10, length.out = 250), shape = alpha, rate = beta), 
      type = "l", 
      col = myred, lty = 2, lwd = 2)
rug(x)

```

# Repartiția Beta

Spunem că o variabilă aleatoare $X$ este repartizată *Beta* de parametrii $(\alpha, \beta)$, cu $\alpha, \beta > 0$, și se notează cu $X\sim B(\alpha,\beta)$, dacă densitatea ei are forma 

$$
  f_X(x) = \frac{1}{B(\alpha, \beta)} x^{\alpha-1} (1-x)^{\beta-1},\quad 0\leq x\leq 1.
$$
unde $B(\alpha, \beta)$ este funcția (Beta, numită și integrală Euler de primul tip) definită prin 

$$
  B(\alpha, \beta) = \int_{0}^{\infty}x^{\alpha-1} (1-x)^{\beta-1}\,dx,\quad \forall \alpha, \beta >0.
$$

```{r, echo=FALSE, out.width=dimplot}
# shape - rate parametrization
alpha = 0.5
beta = 0.5
  
u = seq(0, 1, by=.01)

plot(u,dbeta(u, shape1 = alpha, shape2 = beta),type="l", axes=FALSE,
     xlab="", ylab="", col="white",
     main = TeX("Densitatea repartitiei $B(\\alpha, \\beta)$"),
     ylim = c(0, 2.5))

axis(1, labels = F, tcl = 0)

I = which((u<=0.75) & (u>=0.35))

polygon(c(u[I],rev(u[I])),c(dbeta(u, shape1= alpha, shape2 = beta)[I],rep(0,length(I))),
        col=col_fill, border=NA)

lines(u,dbeta(u, shape1= alpha, shape2 = beta), lwd=3, col=col_border)

text(.4, dbeta(0.5, shape1= alpha, shape2 = beta)+.85, TeX("$P(x_1\\leq X\\leq x_2)=\\int_{x_1}^{x_2} \\frac{1}{B(\\alpha, \\beta)} t^{\\alpha-1} (1-t)^{\\beta-1}\\, dt$"), cex = 1)
arrows(0.4, dbeta(0.5, shape1= alpha, shape2 = beta)+.55, 0.5, 0.2,
       length = 0.15, angle = 20, lty = 2)

axis(side = 1, at = c(0, 0.35, 0.75), 
     labels = c(0, TeX("$x_1$"), TeX("$x_2$")), 
     font = 2)

```

```{r, type = "rmdexercise", engine = engine_block}
Arătați că funcția Beta $B(\alpha, \beta)$ verifică următoarele proprietăți:

  1) $B(\alpha, \beta) = \frac{\Gamma(\alpha)\Gamma(\beta)}{\Gamma(\alpha+\beta)}$
  2) $B(\alpha, \beta) = B(\beta, \alpha)$
  3) $B(\alpha, \beta) = B(\alpha, \beta+1) + B(\alpha+1, \beta)$
  4) $B(\alpha + 1, \beta) = B(\alpha, \beta) \frac{\alpha}{\alpha+\beta}$ și $B(\alpha, \beta + 1) = B(\alpha, \beta) \frac{\beta}{\alpha+\beta}$.


```

Funcția de repartiție a unei variabile aleatoare $X\sim B(\alpha, \beta)$ este dată de 

$$
  F_{X}(x) = \int_{-\infty}^{x}f_X(t)\,dt = \frac{1}{B(\alpha, \beta)} \int_{-\infty}^{x} t^{\alpha-1} (1-t)^{\beta-1}\,dt
$$

și nu are o formulă explicită de calcul. 

```{r, echo=FALSE, out.width=dimplot}
# shape - rate parametrization
alpha = 0.5
beta = 0.5

a = seq(0, 1, by=.001)

plot(a, pbeta(a, shape1 = alpha, shape2 = beta),type="l",  
     bty = "n", axes = FALSE,
     xlab="", ylab = TeX("$F(x)$"), col="white",
     main = TeX("Functia de repartitie a repartitiei $B(\\alpha,\\beta)$"),
     ylim = c(0,1))

axis(1, labels = F, tcl = 0, 
     col = "grey20")

axis(2, labels = F, tcl = 0,
     col = "grey20")

lines(a, pbeta(a, shape1 = alpha, shape2 = beta), lwd=3, col=col_border)

z1 = 0.75
z2 = 0.4

segments(-0.5, z1, qbeta(z1, shape1 = alpha, shape2 = beta), z1, 
         lty = 2)
segments(qbeta(z1, shape1 = alpha, shape2 = beta), z1, qbeta(z1, shape1 = alpha, shape2 = beta), -0.5,  
         lty = 2)

segments(-0.5, z2, qbeta(z2, shape1 = alpha, shape2 = beta), z2, 
         lty = 2)
segments(qbeta(z2, shape1 = alpha, shape2 = beta), z2, qbeta(z2, shape1 = alpha, shape2 = beta), -0.5,  
         lty = 2)

text(0.1, (z1+z2)/2, TeX("$P(x_{1}\\leq X\\leq x_{2})$"), cex = 0.8)

arrows(0, z1, 0, z2,
       length = 0.15, angle = 20, lty = 2, code = 3)

axis(side = 1, 
     at = c(qbeta(z2, shape1 = alpha, shape2 = beta), qbeta(z1, shape1 = alpha, shape2 = beta)), 
     labels = c(TeX("$x_{1}$"), TeX("$x_{2}$")), 
     font = 2)

axis(side = 2, at = c(0, 1), 
     labels = c("0", "1"),
     las = 2,
     font = 2)

```

Observăm că repartiția $B(1, 1)$ coincide cu repartiția $\mathcal{U}([0,1])$. 

Media și varianța variabilei aleatoare $X$ repartizate Gamma de parametrii $B(\alpha, \beta)$ sunt egale cu

$$
  \mathbb{E}[X] = \frac{\alpha}{\alpha+\beta},\quad Var(X) = \frac{\alpha\beta}{(\alpha+\beta)^2(\alpha+\beta+1)}.
$$

Observăm că $Var(X)\leq\mathbb{E}[X](1-\mathbb{E}[X])$.

```{r, type = "rmdexercise", engine = engine_block}
Arătați că media și varianța unei variabile aleatoare repartizate Beta de parametrii $\alpha$ și $\beta$ sunt egale cu

$$
  \mathbb{E}[X] = \frac{\alpha}{\alpha+\beta},\quad Var(X) = \frac{\alpha\beta}{(\alpha+\beta)^2(\alpha+\beta+1)}. 
$$


```

În R putem să

  - generăm observații independente din repartiția $B(\alpha, \beta)$ (e.g. $\alpha = 2.5$, $\beta = 1$)
  
```{r}
rbeta(15, shape1 = 2.5, shape2 = 1)
```

  - calculăm densitatea unei variabile aleatoare repartizate $B(\alpha, \beta)$ în diferite puncte
  
```{r}
dbeta(seq(0, 1, length.out = 20), shape1 = 1, shape2 = 3)
```

  - calculăm funcția de repartiție a unei variabile repartizate $B(\alpha, \beta)$ pentru diferite valori
  
```{r}
pbeta(seq(0, 1, length.out = 15), shape1 = 1, shape2 = 3)
```

  - calculăm cuantilele de ordin $p\in(0,1)$ 
  
```{r}
qbeta(c(0.01, 0.025, 0.05, 0.25, 0.5, 0.75, 0.95, 0.975, 0.99), shape1 = 1, shape2 = 3)
```

```{r, type = "rmdexercise", engine = engine_block}
Fie $X$ o variabilă aleatoare repartizată $B(\alpha, \beta)$. Pentru fiecare pereche de parametrii $(\alpha, \beta)$ din mulțimea $\{(0.5,0.5), (1, 3), (5, 1), (2, 2), (2, 5)\}$ trasați pe același grafic densitățile repartițiilor Beta cu parametrii $(\alpha, \beta)$. Adăugați legendele corespunzătoare. Aceeași cerință pentru funcțiile de repartiție.


```

```{r, echo=FALSE, out.width=dimplot}
pars = matrix(c(0.5, 0.5, 1, 3, 5, 1, 2, 2, 2, 5), 
              ncol = 2, byrow = TRUE)

x = seq(0, 1, length.out = 250)

set.seed(1234)
cols = sample(colors(), nrow(pars))

par(mfrow = c(1, 2))
# densitatile
plot(x, dbeta(x, shape1 = pars[1, 1], shape2 = pars[1, 2]),
     xlab = "x",
     ylab = TeX("$f(x)$"),
     ylim = c(0,2.5),
     col = myred, 
     lwd = 2, type = "l",
     bty = "n",
     main = "Densitatea")

for (i in seq(nrow(pars)-1)){
  alpha = pars[i+1, 1]
  beta = pars[i+1, 2]
    
  y = dbeta(x, shape1 = alpha, shape2 = beta)
  
  lines(x, y, lwd = 2, 
        col = cols[i])
}

legend(0.35, 2.5, 
       legend = TeX(paste0("$\\alpha = ", pars[,1], ", \\beta = ", pars[,2], "$")),
       col = cols,
       lwd = rep(2, nrow(pars)),
       bty = "n",
       cex = 0.6,
       seg.len = 1.5)

# functiile de repartitie
plot(x, pbeta(x, shape1 = pars[1, 1], shape2 = pars[1, 2]),
     xlab = "x",
     ylab = TeX("$F(x)$"),
     ylim = c(0,1),
     col = myred, 
     lwd = 2, type = "l",
     bty = "n", 
     main = "Functia de repartitie")

for (i in seq(nrow(pars)-1)){
  alpha = pars[i+1, 1]
  beta = pars[i+1, 2]
  
  y = pbeta(x, shape1 = alpha, shape2 = beta)
  
  lines(x, y, lwd = 2, 
        col = cols[i])
}

legend("topleft", 
       legend = TeX(paste0("$\\alpha = ", pars[,1], ", \\beta = ", pars[,2], "$")),
       col = cols,
       lwd = rep(2, nrow(pars)),
       bty = "n",
       cex = 0.6,
       seg.len = 1.5)
```

```{r, type = "rmdexercise", engine = engine_block}
Generați $250$ de observații din repartiția $B(3,3)$, trasați histograma acestora și suprapuneți densitatea repartiției date (vezi figura de mai jos).


```

```{r, echo=FALSE, out.width=dimplot, message=FALSE, warning=FALSE}
# shape - rate parametrization
alpha = 3
beta = 3

set.seed(1234)
x = rbeta(250, shape1 = alpha, shape2 = beta)

par(fig = c(0, 1, 0, 0.45))
boxplot(x, horizontal=T, bty="n", xlab="X",
        col = "grey80",
        ylim = c(0,1))

par(fig = c(0, 1, 0.25, 1), new = T)
hist(x, 
     probability = TRUE, 
     # breaks = seq(0, 5, by = 0.25),
     xlim = c(0, 1),
     ylim = c(0, 2.5),
     col = "grey80",
     main = TeX("Repartitia $B(3,3)$"),
     xlab = "",
     ylab = "Densitatea")

lines(seq(0, 1, length.out = 250),
      dbeta(seq(0, 1, length.out = 250), shape1 = alpha, shape2 = beta), 
      type = "l", 
      col = myred, lty = 2, lwd = 2)
rug(x)

```




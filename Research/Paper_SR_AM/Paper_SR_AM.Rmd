---
title: 'TWO DECADES OF RESEARCH COLLABORATION: A KEYWORD SCOPUS EVALUATION '
author: Alexandru Amarioarei (alexandru.amarioarei@incdsb.ro), Mihaela Paun^[Corresponding
  Author - to whom all correspondence should be directed] (mihaela.paun@incdsb.ro)
date: Bioinformatics Department, National Institute of Research and Development for
  Biological Sciences, Bucharest, Romania
output:
  html_document:
    fig_caption: yes
    number_sections: yes
    toc: yes
    toc_float:
      collapsed: no
  pdf_document:
    keep_tex: yes
    number_sections: yes
    toc: yes
    toc_depth: 3
  word_document:
    fig_caption: yes
    highlight: pygments
    keep_md: yes
    reference_docx: template/template.docx
    toc: no
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE)
```

```{r, echo=FALSE, include=FALSE}
# Set the working directory
#--------------------------

wdSR = "C:/Users/amari/OneDrive/lucrari lucrate in Romania/Lucrare Statistical Reviews web"

setwd(wdSR)

# Load some functions
#--------------------
source("functions/CapitalizeWord.R")
source("functions/deleteNA.R")
source("functions/ensure_library.R")
source("functions/figureNumber.R")
source("functions/multiplot.R")
source("functions/tableNumber.R")
source("functions/searchWords.R")
source("functions/comp_hindex.R")

# Load packages 
# General packages
#-----------------
require_library("readxl")
require_library("tidyr")
require_library("dplyr")
require_library("stringr")
require_library("stringi")
require_library("ggplot2")
require_library("knitr")
require_library("reshape2")

# graph packages
#----------------
suppressMessages(library("ggnetwork"))
suppressMessages(library("network"))
suppressMessages(library("Matrix"))
suppressMessages(library("sna"))

# Maps
#-----------------
require_library("tmap")
require_library("ggmap")
require_library("ggrepel")
require_library("GGally")
```

```{r, echo=FALSE, include=FALSE}
# Read data into a single file: dat.combined
#--------------------------------------------

words = read.csv("dataIn/cuvinte.csv", stringsAsFactors = FALSE)
names(words) = c("ID","Key")

words$Key2 = str_replace(words$Key, " ", "_")

dat.combined = read.csv(paste0("dataIn/Words/", words$Key2[1],".csv"), stringsAsFactors = FALSE)
dat.combined$Word = words$Key[1]

hgindex = comp_hgindex(dat.combined)

dat.combined$Hindex = hgindex[1]
dat.combined$Gindex = hgindex[2]

for (i in 2:length(words$Key)){
  print(i)
  dat = read.csv(paste0("dataIn/Words/", words$Key2[i],".csv"), stringsAsFactors = FALSE)
  dat$Word = words$Key[i]
  
  hgindex = comp_hgindex(dat)
  
  dat$Hindex = hgindex[1]
  dat$Gindex = hgindex[2]
  
  dat.combined = rbind(dat.combined, dat)
}

# writing the file 
# write.csv(dat.combined, "dataOut/data_Combined.csv")

# Summarise Data
#-------------------

dat.Year.Words = dat.combined %>% group_by(Word, Year) %>% summarise(count = n())

dat.Year.Words2 = data.frame(Year = rep("", length(unique(dat.Year.Words$Word))), 
                             count = rep("", length(unique(dat.Year.Words$Word))), 
                             Word = rep("", length(unique(dat.Year.Words$Word))))
```

# Abstract

One issue that has become more important over the years is to evaluate the capability for worldwide research networks on different areas of research, especially in the areas that are identified as being worldwide significant. The study investigated the research output, citations impact and collaborations on publications listed in *Scopus* authored by researchers all over the world, research published between *1999-2014*, selected by a group of keywords identified by authors. The results of the analysis identified an increasing trend in scientific publications starting with *2006*, especially on three of the analyzed keywords. We also found differences in the citations patterns for the *Black Sea* and *Danube Delta* keywords in the contributing countries. The results of this study revealed a steady increase of the collaboration output and an increasing trend in the collaboration behavior, both at the European and national level.

**Keywords: Statistical software R, data collection, research, citations, articles, collaboration networks**

**JEL Classification: O15, O32, C80, C88**

# Introduction

Governments and non-governmental organizations and companies worldwide have been increasingly explored how the publication and use of open and linked data can have impacts not only on knowledge, but also on policy, governance, economic growth and societal challenges. Environmental research has exhibited an increasing trend in the number of publications in the last two decades, as well as the number of researchers involved in this research area and consequently the impact of the environmental research in the academic community has greatly increased. (*Halevi, 2014*) conducted a comprehensive search in *Scopus* data between *2001-2011* on a list of limited subject categories to identify the highly cited articles, performing an in-depth analysis in the top *5* articles in each area. 

In 2013, the UK department of Business, Innovation and Skills commissioned Elsevier to assess the performance of UK's research with respect to the performance of seven other selected countries (*Elsevier, 2013*), addressing publications trend, global research collaboration, research impact, strength and vulnerable areas and the share of global articles. In 2012, on all published articles, UK ranked third after United States and China, consistent with our findings for the keywords identified. (*Kim, 2016*) presented the results of the investigation of the research trends and collaboration status of China, Japan and South Korea regarding marine biodiversity through a bibliometric analysis of scientific articles on Web of Science data for a 20-year period. The study focused on identifying the countriesâ€™ research trends and collaboration trend, since it was considered significant for the strategic policy-making, economic and political environment. 

The European Commission invests for the 2014-2020 funding period, through the LIFE financial instrument over 34 billion euros in nature conservation and climate change research projects (*LIFE, 2013*), with three priority areas nature and biodiversity, environment and resource efficiency, climate change adaptation, encouraging the participation of countries outside EU, as well. When involved in science policies, scientific collaboration and interactions among research institutions and scientists is viewed as an essential characteristic. In the last two decades one can see a trend of a remarkable increase in collaboration between countries, between and within institutions, both in the scope of scientific output, as well as policy initiatives (*Melin, 1996*). Through funded projects with more institutional participation, the research produced is a result of a collaborative network, where costly experiments and studies can be conducted by the joint effort of the participants and where the entities involved are not only universities, but also research institutes and industry. 

The present study presents the summarized information regarding funded research and research collaboration in the past two and a half decades, focusing on environmental sciences and identifying a set of priority research actions among the conducted research analyzed. 

Once the set of keywords is identified (the process is described in the next section), the focus of the paper is on the analysis of research and collaboration on biodiversity, climate change at the global level and zoomed inside these areas on the research on *Danube Delta* and *Black Sea* at the national level.

Given the preparatory phase of the strategic national project *DANUBIUS-RI* that is implemented under the coordination of Romania, with the hub in Danube Delta, Murighiol, the findings of this study will provide a good reference for policymakers and researchers to expand the existing collaboration networks and research efforts in the identified priority directions.


# Materials and method

Through the effort funded under the European Commission FP7 - Environment project, "_DANube macroregion: Capacity building and Excellence in River Systems (basin, delta and sea)_" - *DANCERS*, data has been gathered on what has been accomplished in the Danube basin in the last two decades. While performing analysis on the metadatabase  ([http://www.dancers-fp7.eu/](http://www.dancers-fp7.eu/)) created under this project, database that  gathered information about all existing projects and programmes regarding water management and environmental issues in the Danube Basin in the last two decades, strengths, weaknesses of the outcomes of two decades of research in this area were identified, as well as solutions to the gaps identified by a comprehensive analysis of the data.

Out of the *478* projects entered in the metadatabase, *397* were projects with complete information that were analyzed. The projects were collected with the help of an especially designed online questionnaire ([http://bioinformatica.dbioro.eu/doc/QUESTIONNAIRE.pdf](http://bioinformatica.dbioro.eu/doc/QUESTIONNAIRE.pdf)) and by using internet search tools. The mapping and analysis in this article^[This article was created in [_Rmarkdown_](http://rmarkdown.rstudio.com/) and it is reproducible. All tables and figures that appear in this article are automatically created (follow this [_link_]() for the source code).] were performed using the open source software R ([https://cran.r-project.org/](https://cran.r-project.org/)). These projects were projects coordinated during *1993-2014* and were catalogued as projects with thematic areas in _Life Sciences_, _Earth Sciences_, _Socio Economics_ and _Multidisciplinary Sciences_. The thematic focus of the evaluated projects in total was distributed as follows: `Figure 1` presents the projects distribution by thematic areas. One can note that *26.1%* of the projects are projects that were subscribed in more than one of the four categories presented above, *26.1%* were multidisciplinary projects, and about *22.3%* of the projects were Life Science projects, and the rest Earth Sciences and Socio Economics projects.

```{r, echo=FALSE, include=FALSE}
bp.df = data.frame(Areas = c("Life Sciences", "Earth Sciences", "Socio Economics", "Multidisciplinary Sciences", "Multi Choice Answer"),
                   Nr = c(0.223, 0.145, 0.116, 0.261, 0.261))

```

```{r thematic_area_projects, echo=FALSE, fig.show='hold', fig.width=8, fig.cap=fn("Thematic area of the projects")}
bp<- ggplot(bp.df, aes(x="", y=Nr, fill=Areas)) + geom_bar(width = 2, stat = "identity", colour = "white")
pie <- bp + coord_polar("y", start=0)

pie + theme_bw()+ 
  theme(axis.ticks = element_blank(), axis.text.x = element_blank(),panel.border = element_blank(), panel.grid=element_blank()) + 
  labs(x = "", y = "", fill = "Thematic areas") + 
  scale_fill_brewer(palette = "Set2")+
  theme(legend.text = element_text(size = 8, face = "bold")) + 
  geom_text(aes(x = 2.4, y = cumsum(Nr)-Nr/2, label = paste0(format(Nr*100, digits = 3), "%")), size=4, fontface = "bold")
```

Investigating the top keywords associated with each project entered in the database for the collected *397* projects, a set of keywords, consistently associated with the research performed and outcomes was selected. The set of representative keywords to Danube research contains the following: *water management*, *pollution control*, *ecosystem*, *Danube*, *Danube Delta*, *climate change*, *environmental protection*, *biodiversity*, *flood risk*, *sustainable development*, *biomaterials*, *biofuels*, *nanomaterials*, *bioeconomy*, *biobanking* and *Black Sea*.

The analysis carried out in this manuscript is focused on evaluating quantitatively (number of publications) and qualitatively (impact through the citations number) the research having one or more of the above keywords in the interval *1999-2015*. Once the keywords set was selected from the projects records, the evaluation analysis was performed on data from the [Scopus](www.scopus.com) database. For each keyword in the data set, a search was performed in *Scopus*, **selecting keywords assigned to the document by the author, function AUTHKEY()**. 

A search example:
```{r, echo=FALSE}
print(sir2[2])
```

The *DANCERS* databases collected projects on two decades, starting from *1993* and ending in *2015*, however [Scopus](https://www.scopus.com/) contains incomplete data on research before 1996. The qualitative analysis was adjusted to the *1996-2015* period, since *Scopus* does not have complete citation information for articles published before *1996*; hence the number of citations was investigated only for the period *1999-2015*.

# Results and discussion 

Existing data sources, such as Scopus and *Thomson Reuters Web of Science* have incomplete data caused by irregular coverage, errors or changes in indexing policies and standardization problems (*Taskin, 2014*), (*Bar-Ilan, 2009*).  For a researcher interested in duplicating the analysis or carrying out similar research, some comments regarding the constraints identified need to be made.

-	The citation overview page (an option available in *Scopus*) can display up to 16 years.  A shorter year range has to be selected to have a full display on the page.

-	The search for any given keyword may result in a large number of results. If one is interested in viewing the results, one has to keep in mind that only the first 2000 records can be viewed.  One of the available ways to overcome the issue is to change the sort order of the results to view more of the results.

`Table 1` summarizes the number of publications and citations that were identified in the *Scopus* index papers for each of the keywords identified as consistently describing the funded research grants collected into the mentioned metadatabase.

```{r, echo=FALSE}
# table with the number of papers and citations per keyword
dat.tab_wc = dat.combined %>% group_by(Word, Hindex, Gindex) %>% summarise(count = n(), cited = sum(as.numeric(Cited.by), na.rm = TRUE))

kable(dat.tab_wc, 
      digits = 2,
      align = "c", 
      col.names = c("Keyword", "H-index", "G-index", "Number of papers", "Number of citations"),
      caption = tn("The number of publications, citations and the corresponding H-index and G-index for each keyword"))
```

One can see that "*climate change*" is a keyword selected by authors most often in the analyzed time period, appearing in `r dat.tab_wc$count[which(dat.tab_wc$Word == "climate change")]` articles, being also the keyword that identified papers with the largest *H-index* of `r dat.tab_wc$Hindex[which(dat.tab_wc$Word == "climate change")]`. This means that out of the `r dat.tab_wc$count[which(dat.tab_wc$Word == "climate change")]` identified articles, when considering the H-index, `r dat.tab_wc$Hindex[which(dat.tab_wc$Word == "climate change")]` articles has been cited at least `r dat.tab_wc$Hindex[which(dat.tab_wc$Word == "climate change")]` times.  This keyword identified papers that have the largest number of the citations between *1999-2015*, `r as.character(dat.tab_wc$cited[which(dat.tab_wc$Word == "climate change")])` citations.

"*Ecosystem*" is a keyword that was selected by authors in `r dat.tab_wc$count[which(dat.tab_wc$Word == "ecosystem")]` papers and generates the second largest number of citations among the groups having an H-index of `r dat.tab_wc$Hindex[which(dat.tab_wc$Word == "ecosystem")]`. 

It is interesting to note that this keyword has a H-index *1.5* times bigger than the corresponding H-index for *biomaterials*, *biofuels* and *nanomaterials* keywords, although the number of papers, as well as the number of citations for these keywords is four times smaller than it is for those produced by the ecosystem keyword.

"*Biodiversity*" is the keyword that generates the third largest number of papers and citations in the timeframe set for investigation and the third largest H-index, having at least `r dat.tab_wc$Hindex[which(dat.tab_wc$Word == "biodiversity")]` papers with over `r dat.tab_wc$Hindex[which(dat.tab_wc$Word == "biodiversity")]` citations. One should note that there is a similar trend in the self citations number for every keyword in the analysis, between *12-25%* of all citations are citations by author, independent of the number of papers for the keyword or number of citations produced.  One can formulate the hypothesis, that is not tested here, that in every paper, roughly 1 in 5 are citations by author.

As one can see from `Table 2` and illustrated in `Figure 2`, most scientifically productive countries in research focusing on the areas identified in `Table 1` are United States, China, United Kingdom, our findings being supported also by the RELX Group Corporate 2015 report, (*Relx, 2015*).

```{r, echo=FALSE, include=FALSE}
source("functions/mapWorld.R")
```

```{r World_Map, echo=FALSE, fig.show='hold', fig.width=8, fig.cap=fn("World Map")}
tm.World
```

```{r, echo=FALSE}
dat.World.Articles = data.frame(Name = World$name, NArt = World$Articles)
dat.World.Articles = dat.World.Articles[order(dat.World.Articles$NArt, decreasing = TRUE),]
dat.World.Articles$ID = 1:length(dat.World.Articles$NArt)
dat.World.Articles = dat.World.Articles[, c(3,1,2)]

# dat.tab_country = dat.combined.Country %>% group_by(Country) %>% summarise(count = sum(Articles, na.rm = TRUE))
# dat.tab_country = dat.tab_country[order(dat.tab_country$count, decreasing = TRUE),]

tab.CountryArticles = dat.World.Articles[1:10,]
rownames(tab.CountryArticles) = NULL

kable(tab.CountryArticles, 
      digits = 2,
      align = "c", 
      col.names = c("ID", "Country", "Number of articles"),
      caption = tn("Top ten most productive countries in the world"))
```

One can note a significant increase in the number of papers at the interface of climate change, biodiversity and ecosystems in North and South America, Australia and Asia, indicating that the importance of both these research areas, as well and the interconnections among them was identified, (*Dangles, 2016*). The 2003-2012 ecological climate change impact research was evaluated in some studies in the literature, (*Felton, 2009*) and (*Jaeschke, 2014*).

The European Commission Joint Research Center carries out research to alleviate the effects of climate change and to preserve the environment. Starting with 1991, the European Commission's has taken many initiatives related to climate change, environment and biodiversity, several programs funding research in these areas. (*Zhang, 2012*) identified UK as one of the leading countries in climate change research and the country with does the top research in climate change in Europe) based on ranking the *314* climate change research institutes according to the scores in terms of Policy, Academic, Enterprise, Public and Comprehensive influence, a characteristic consistent with our findings on the analysis of the research published in the *1999-2015* period. 

Our analysis highlighted the fact that the top countries in Europe, ranked by publications, performing research in the key areas identified in `Table 1`, are United Kingdom, Germany and France, with Romania being ranked as `17` in the classification, see `Table 3`.

```{r Europe_Map, echo=FALSE, fig.show='hold', fig.width=7, fig.height=6, fig.cap=fn("Europe Map")}
tm.Europe
```

```{r, echo=FALSE}
dat.Europe.Articles = data.frame(Name = Europe$name, NArt = Europe$Articles)
dat.Europe.Articles = dat.Europe.Articles[order(dat.Europe.Articles$NArt, decreasing = TRUE),]
dat.Europe.Articles$ID = 1:length(dat.Europe.Articles$NArt)
dat.Europe.Articles = dat.Europe.Articles[, c(3,1,2)]

tab.EuropeCountryArticles = dat.Europe.Articles[1:11,]

tab.EuropeCountryArticles[11, ] = dat.Europe.Articles[which(dat.Europe.Articles$Name == "Romania"),]

rownames(tab.EuropeCountryArticles) = NULL

kable(tab.EuropeCountryArticles, 
      digits = 2,
      align = "c", 
      col.names = c("ID", "Country", "Number of articles"),
      caption = tn("Top ten most productive countries in Europe and the rank occupied by Romania"))
```

An illustration of the number of publications by year in the time period *1999-2015* illustrates a significant increasing trend in research output in climate change, ecosystem and biodiversity, all three categories changing the growing rate in *2006*, `Figure 4`.

```{r , echo=FALSE, include=FALSE}
# Plot 1 - number of papers 
#+++++++++++++++++++++++++++

dat.Year.Words2$Year = rep(2015, length(unique(dat.Year.Words$Word)))
dat.Year.Words2$count = dat.Year.Words$count[which(dat.Year.Words$Year == "2015")]
dat.Year.Words2$Word = unique(dat.Year.Words$Word)
```

```{r Pubs_per_Year, echo=FALSE, fig.show='hold', fig.width=8, fig.cap=fn("The number of publications per year")}
ggplot(dat.Year.Words, aes(x = Year, y = count)) + 
  geom_text_repel(aes(x = Year, 
                      y = count, 
                      label = Word,
                      colour = Word), 
                  data = dat.Year.Words2,
                  size = 2.75, 
                  fontface = 'bold',
                  box.padding = unit(0.5, 'lines'),
                  point.padding = unit(1.6, 'lines'),
                  segment.color = '#555555',
                  arrow = arrow(length = unit(0.01, 'npc')))+
  geom_line(aes(color = Word)) + 
  geom_point(aes(color = Word)) + 
  theme_bw()+
  labs(x = "", y = "Number of publications", colour = "Search Keywords")+
  scale_x_continuous(breaks = c(1999:2015), labels = as.character(1999:2015))+
  theme(legend.title = element_text(size = 10), 
        axis.title.y = element_text(size = 10),
        legend.text = element_text(size = 8),
        axis.text = element_text(size = 8),
        axis.text.y = element_text(size = 6),
        axis.text.x = element_text(angle = 45,vjust = 0.5),
        legend.key.size = unit(4, "mm"))
```

```{r, echo=FALSE, include=FALSE}
# Plot 2 - number of citations
#++++++++++++++++++++++++++++++

dat.combined$Cited.by = as.numeric(dat.combined$Cited.by) # transform to a numeric variable
dat.Year.Citations = dat.combined %>% group_by(Word, Year) %>% summarise(count = sum(Cited.by, na.rm = TRUE))

dat.Year.Citations2 = dat.Year.Citations %>% group_by(Word) %>% mutate(CS = cumsum(count))

dat.Year.Words3 = data.frame(Year = rep("", length(unique(dat.Year.Citations2$Word))), 
                             count = rep("", length(unique(dat.Year.Citations2$Word))), 
                             Word = rep("", length(unique(dat.Year.Citations2$Word))))

dat.Year.Words3$Year = rep(2015, length(unique(dat.Year.Citations2$Word)))
dat.Year.Words3$count = dat.Year.Citations2$CS[which(dat.Year.Citations2$Year == "2015")]
dat.Year.Words3$Word = unique(dat.Year.Citations2$Word)
```

The citation number follows a similar trend as the number of publications, the three research areas being clearly delimited with respect the other research areas analyzed, the growing rate slowing in 2014, `Figure 5`.

```{r Citations_Year, echo=FALSE, fig.show='hold', fig.width=8, fig.cap=fn("Cumulative number of citations per year")}
plot_pub_cit_year = ggplot(dat.Year.Citations2, aes(Year, CS)) + 
  geom_text_repel(aes(x = Year, 
                      y = count, 
                      label = Word, 
                      colour = Word), 
                  data = dat.Year.Words3,
                  size = 2.75, 
                  fontface = 'bold',
                  box.padding = unit(0.5, 'lines'),
                  point.padding = unit(1.6, 'lines'),
                  segment.color = '#555555',
                  arrow = arrow(length = unit(0.01, 'npc')))+
  geom_line(aes(color = Word)) + 
  geom_point(aes(color = Word)) + 
  theme_bw()+
  scale_x_continuous(breaks = c(1999:2015), labels = as.character(1999:2015))+
  labs(x = "", y = "Cumulative number of citations", colour = "Search Keywords")+
  theme(legend.title = element_text(size = 10), 
        axis.title.y = element_text(size = 10),
        legend.text = element_text(size = 8),
        axis.text = element_text(size = 8),
        axis.text.y = element_text(size = 6),
        axis.text.x = element_text(angle = 45,vjust = 0.5),
        legend.key.size = unit(4, "mm"))

plot_pub_cit_year
```

A ranking of the top ten countries in terms of number of published papers for each keyword identified in `Table 1` is presented in `Appendix A`.

```{r, echo=FALSE, include=FALSE}
library(bibliometrix)# use a bibliography package 


DDBS = readLines("dataIn/DDBS/DanubeDelta_BlackSea.bib")

DDBS.df <- convert2df(DDBS, dbsource = "scopus", format = "bibtex")# transform to dataframe 

# Bibliometric analysis
#------------------------
DDBS.results <- biblioAnalysis(DDBS.df, sep = ";")

DDBS.S = summary(object = DDBS.results, k = 10, pause = FALSE)

# Articles per year and average citations per article 
#+++++++++++++++++++++++++++++++++++++++++++++++++++++

DDBS.df2 = DDBS.df %>% mutate(MA = unlist(lapply(DDBS.df$AU, function(x){
                                  l = str_split(x, ";")
                                  length(l[[1]])
                                })),
                                MAT = ifelse(MA>1,"M","S"))

DDBS.df.apy = DDBS.df2 %>% group_by(PY) %>% summarise(count = n())
DDBS.df.apy$MAT = "T"
names(DDBS.df.apy) = c("Year", "NArt", "MAT")
DDBS.df.apy = as.data.frame(DDBS.df.apy)

DDBS.df.mapy = DDBS.df2 %>% group_by(PY, MAT) %>% summarise(count = n()) %>% filter(MAT == "M") # multiple authored articles per year
DDBS.df.mapy = DDBS.df.mapy[,c(1,3,2)]
names(DDBS.df.mapy) = c("Year", "NArt", "MAT")
DDBS.df.mapy = as.data.frame(DDBS.df.mapy)

DDBS.df.AY = rbind(DDBS.df.apy, DDBS.df.mapy)
```

The two keywords that identified *Romania* as one of the top 10 contributors were *Danube Delta* and *Black Sea*. There were `r length(DDBS.df$AU)` papers published, having these two keywords in the analyzed period, showing an increasing trend in publication in the period *2005-2014*. Since when the data was gathered year 2015 still had some papers to be indexed in the database, the drop in number of publication may not be supported. As one can see in `Figure 6`, most of these papers were multi-author articles, exhibiting a similar trend as the total number of articles.

```{r Total_Multi_Authored, echo=FALSE, fig.show='hold', fig.width=8, fig.cap=fn("Total and Multi-Authored Articles per year")}
ggplot(DDBS.df.AY, aes(colour = MAT))+ 
  geom_point(aes(x = Year, y = NArt, group = 1), data = DDBS.df.AY[which(DDBS.df.AY$MAT == "T"),]) + 
  geom_line(aes(x = Year, y = NArt, group = 1), data = DDBS.df.AY[which(DDBS.df.AY$MAT == "T"),], linetype = 2) + 
  
  geom_point(aes(x = Year, y = NArt, group = 1), data = DDBS.df.AY[which(DDBS.df.AY$MAT == "M"),]) + 
  geom_line(aes(x = Year, y = NArt, group = 1), data = DDBS.df.AY[which(DDBS.df.AY$MAT == "M"),], linetype = 2) + 
  
  scale_color_discrete(breaks = c("T", "M"), labels = c("Total Articles", "Multi-Authored Articles"))+
  theme_bw()+
  labs(x = "", y = "Number of articles", colour = "")+
  theme(legend.title = element_text(size = 10), 
        axis.title.y = element_text(size = 10),
        legend.text = element_text(size = 8),
        axis.text = element_text(size = 8),
        axis.text.y = element_text(size = 6),
        axis.text.x = element_text(angle = 45,vjust = 0.5),
        legend.key.size = unit(4, "mm"))
```

```{r, echo=FALSE, include=FALSE}
# 10 Most productive countries
#++++++++++++++++++++++++++++++++

# Data preparation 
source("functions/CapitalizeWord.R")

DDBS.df.ca = DDBS.S$MostProdCountries
names(DDBS.df.ca) = c("Country", "Articles", "Freq")
DDBS.df.ca$Articles = as.numeric(DDBS.df.ca$Articles)
DDBS.df.ca$Country = as.character(DDBS.df.ca$Country)
DDBS.df.ca$Country = str_replace_all(DDBS.df.ca$Country, "\\s+$", "") # remove all trailing space from the end 

DDBS.df.ca$Country = tolower(DDBS.df.ca$Country)
DDBS.df.ca$Country = sapply(DDBS.df.ca$Country, CapitalizeWord)
DDBS.df.ca$Country[which(DDBS.df.ca$Country == "Usa")] = "United States"
  
DDBS.df.ca$Country = factor(DDBS.df.ca$Country, levels = DDBS.df.ca$Country[order(DDBS.df.ca$Articles, decreasing = FALSE)])

#++++++++++++
DDBS.df.ctc = DDBS.S$TCperCountries
names(DDBS.df.ctc) = c("Country", "Total.Citations", "AAC")
DDBS.df.ctc$Total.Citations = as.numeric(DDBS.df.ctc$Total.Citations)
DDBS.df.ctc$Country = as.character(DDBS.df.ctc$Country)
DDBS.df.ctc$Country = str_replace_all(DDBS.df.ctc$Country, "\\s+$", "") # remove all trailing space from the end

DDBS.df.ctc$Country = tolower(DDBS.df.ctc$Country)
DDBS.df.ctc$Country = sapply(DDBS.df.ctc$Country, CapitalizeWord)
DDBS.df.ctc$Country[which(DDBS.df.ctc$Country == "Usa")] = "United States"

DDBS.df.ctc$Country = factor(DDBS.df.ctc$Country, levels = DDBS.df.ctc$Country[order(DDBS.df.ctc$Total.Citations, decreasing = FALSE)])
```

Romania is ranked second in the number of publications with keywords *Danube Delta* or *Black Sea* and only ranks `r which(DDBS.df.ctc$Country == "Romania")` in terms of the citations numbers, `Figure 7`. Among the citations received by these two categories, an average of only `78.63%` were identified as citations without no self citation, a percentage smaller than the percentage for the other categories that were identified to be above `80%`. (*Ghane, 2011*) performed a comparison analysis between Iran and Turkey on author self-citation. 

The result indicated the influence of author self citation is to some extent a citation behavior at national and international level and discipline differentials, with Iran exhibiting a stronger tendency towards self-citation as compared to Turkey. To what extent this justifies the larger number of self citations in these two categories and if and how much this percentage can be attributed to the top three countries (Turkey, Romania and Ukraine) that published in this area, it is not addressed in this analysis. (*Sangwal, 2013*) identified that for the analysis performed in 2008 journals indexed in the 2008 JCR database from Romania, Turkey and Brazil show high self-citations, part of these journals being indexed in Scopus, as well.

```{r Most_Prod_Countries_DDBS, echo=FALSE, fig.show='hold', fig.width=8, fig.cap=fn("Most productive countries")}
# Plots 

plot.Country.CA = ggplot(data = DDBS.df.ca)+
  geom_bar(aes(x = Country, y = Articles, fill = Country), stat = "identity", colour = "#777777", width = 0.5)+ 
  scale_fill_brewer(palette = "Spectral")+
  geom_text(aes(x = Country, y = Articles, label = as.character(Articles)), 
            hjust = -0.5, color = "#444444", size = 3, fontface = "bold")+
  coord_flip(ylim = c(0, max(DDBS.df.ca$Articles)+20))+
  theme_bw()+
  ggtitle(paste0('Documents by country for "', "Danube Delta or Black Sea", '" keywords'))+
  labs(x = "", y = "Number of articles")+
  theme(legend.position = "none", 
        title = element_text(size = 10))

plot.Country.CTC = ggplot(data = DDBS.df.ctc)+
  geom_bar(aes(x = Country, y = Total.Citations, fill = Country), stat = "identity", colour = "#777777", width = 0.5)+ 
  scale_fill_brewer(palette = "Spectral")+
  geom_text(aes(x = Country, y = Total.Citations, label = as.character(Total.Citations)), 
            hjust = -0.5, color = "#444444", size = 3, fontface = "bold")+
  coord_flip(ylim = c(0, max(DDBS.df.ctc$Total.Citations)+30))+
  theme_bw()+
  ggtitle(paste0('Documents by country for "', "Danube Delta or Black Sea", '" keywords'))+
  labs(x = "", y = "Number of citations")+
  theme(legend.position = "none", 
        title = element_text(size = 10))

multiplot(plot.Country.CA, plot.Country.CTC, cols = 1)
```

`Figure 8` presents the collaboration network of the top *7* collaborators on *Danube Delta* and *Black Sea* research in the analyzed time frame. The data analyzed looks at the affiliation institutions county of each co-author of the papers analyzed. The size of the bullets shows the magnitude of the collaboration number for the respective country, identifying Romania, United States, Ukraine and Turkey as the countries with the highest number of collaboration in this network. The edges of the graph illustrate each country collaborators. As it can be seen in `Table 4`, each country has the most collaborators among its country institutions, and it is highlighted in the table the country with which every country in the network collaborates most. 

```{r, echo=FALSE, include=FALSE}
#++++++++++++++++++++++++++
#++++++++++++++++++++++++++
# ggnetwork 
#++++++++++++++++++++++++++

DDBS.df3 <- metaTagExtraction(DDBS.df, Field = "AU_CO", sep = ";")

NetMatrix <- biblioNetwork(DDBS.df3, analysis = "collaboration", network = "countries", sep = ";")

# delete not linked vertices
ind <- which(Matrix::colSums(NetMatrix)-Matrix::diag(NetMatrix)>0)

##-----------------------------
# ggnetwork 1 - All
#-----------------------------
NET1 <- NetMatrix[ind,ind]

# Select number of vertices to plot
n <- 7    # n. of vertices
NetDegree1 <- sort(diag(NET1),decreasing=TRUE)[n]
NET1 <- NET1[diag(NET1)>=NetDegree1,diag(NET1)>=NetDegree1]

# delete diagonal elements (self-loops)
# diag(NET) <- 0

rownames(NET1) = tolower(rownames(NET1))
rownames(NET1) = sapply(as.list(rownames(NET1)), CapitalizeWord)

colnames(NET1) = tolower(colnames(NET1))
colnames(NET1) = sapply(as.list(colnames(NET1)), CapitalizeWord)

NET1 = as.matrix(NET1)
bsk.network1 <- network(NET1, directed=F)

NET1b = matrix(NET1, nrow = 1, byrow = TRUE)
NET1b = NET1b[matrix(lower.tri(NET1), nrow = 1, byrow = TRUE)]

e1 <- network.edgecount(bsk.network1)# number of edges 

set.edge.attribute(bsk.network1, "value", NET1b)
set.vertex.attribute(bsk.network1, "vsize", NET1b)
```

```{r collab_network_country, echo=FALSE, fig.show='hold', fig.width=4, fig.cap=fn("Collaboration network between countries")}
# network plot
ggplot(bsk.network1, aes(x = x, y = y, xend = xend, yend = yend)) +
  geom_edges(aes(size = value*0.02), color = "gray", linetype = 2) +
  geom_edgetext(aes(label = value), color = "DarkBlue", fill = "white", size = 3) +
  geom_nodes(aes(size = 2*vsize, colour = as.factor(vsize)), alpha = 0.4) +
  geom_nodes(aes(size = 0.5*vsize, colour = as.factor(vsize))) +
  geom_nodetext_repel(aes(label = vertex.names),
                      fontface = "bold", box.padding = unit(1, "lines"), size = 4) +
  scale_size_area("vsize", breaks = 1:3, max_size = 15)+
  theme_blank()+
  theme(legend.position = "none")+
  ggtitle(paste0("Top ", n, " country collaborations"))
```

```{r, echo=FALSE}
# table top collaborations
NET1_df = as.data.frame(NET1)
NET1_df$Country = rownames(NET1_df)

NET1_df = NET1_df[, c(length(names(NET1_df)), 1:(length(names(NET1_df))-1))]
rownames(NET1_df) = NULL

kable(NET1_df, 
      digits = 2,
      align = "c", 
      caption = tn(paste0("Top ", n," collaborations between contries (including self collaborations)")))
```

`Figure 9` identifies and illustrates the top *10* countries with the institutions of which Romanian institutions collaborated in the last two decades in publications with keywords *Danube Delta* and *Black Sea*, Bulgaria, France and Greece being among the top ranked ones. Particularly, `Table 5` presents the number of publications identified and used for the generation of the network plot in `Figure 9`.

```{r, echo=FALSE, include=FALSE}
##-----------------------------
# ggnetwork 2 - Romania
#-----------------------------

NET2 <- NetMatrix[ind,ind]

# Select number of vertices to plot
n <- 10    # n. of vertices
NetDegree <- sort(diag(NET2),decreasing=TRUE)[n]
NET2 <- NET2[diag(NET2)>=NetDegree,diag(NET2)>=NetDegree]

# delete diagonal elements (self-loops)
# diag(NET) <- 0

NET2[which(rownames(NET2) != "ROMANIA"), which(colnames(NET2) != "ROMANIA")] = 0

rownames(NET2) = tolower(rownames(NET2))
rownames(NET2) = sapply(as.list(rownames(NET2)), CapitalizeWord)

colnames(NET2) = tolower(colnames(NET2))
colnames(NET2) = sapply(as.list(colnames(NET2)), CapitalizeWord)

NET2 = as.matrix(NET2)
bsk.network2 <- network(NET2, directed=F)

e <- network.edgecount(bsk.network2)# number of edges 
atre = NET2[which(rownames(NET2) == "Romania"),]
atre = atre[-which(names(atre) == "Romania")]

set.edge.attribute(bsk.network2, "value", atre)
set.vertex.attribute(bsk.network2, "vsize", atre)
```

```{r Rom_network_plot, echo=FALSE, fig.show='hold', fig.width=4, fig.cap=fn("Collaboration network between Romania and other countries")}
# network plot
ggplot(bsk.network2, aes(x = x, y = y, xend = xend, yend = yend)) +
  geom_edges(aes(size = value*0.01), color = "gray", linetype = 2) +
  geom_edgetext_repel(aes(label = value), color = "grey25", fill = "white") +
  geom_nodes(aes(size = 2*vsize, colour = as.factor(vsize)), alpha = 0.4) +
  geom_nodes(aes(size = 0.5*vsize, colour = as.factor(vsize))) +
  geom_nodetext_repel(aes(label = vertex.names),
                       fontface = "bold", box.padding = unit(1, "lines")) +
  scale_size_area("vsize", breaks = 1:3, max_size = 15)+
  theme_blank()+
  theme(legend.position = "none")+
  ggtitle(paste0("Romania's top ", n, " country collaborations"))
```


```{r, echo=FALSE}
# table
NET_tb = as.data.frame(NET2)
NET_tb$ID = rownames(NET2)
NET_tb = NET_tb[,c(11,1:10)]

NET_tb2 = NET_tb[, c(1,8)]
rownames(NET_tb2) = NULL

names(NET_tb2) = c("ID", "NCol")

NET_tb2 = NET_tb2[order(NET_tb2$NCol, decreasing = TRUE), ]
rownames(NET_tb2) = NULL

kable(NET_tb2, 
      digits = 2,
      align = "c", 
      col.names = c("Countries", "Number of articles"),
      caption = tn("Romania and its collaborations with other countries (including itself)"))
```

```{r, echo=FALSE, include=FALSE, eval=FALSE}
# From here nothing is included in the paper !!!!!!!!!!!
source("functions/mapRo.R")
```

```{r, echo=FALSE, fig.show='hold', fig.width=6, fig.cap=fn("Romanian counties collaboration map"), eval=FALSE}
# From here nothing is included in the paper !!!!!!!!!!!
NetCountyRom
```

# Conclusions

Increase in the number of publications at the intersection of biodiversity, climate change and environmental issues has been tremendously increasing over the last two decades, indicating that scientists both in Europe and in the world have recognized the importance of studying the connections between among these fields. The percentage of publications in these areas of publications has also significantly increased between 2006 and 2014; the increase in publication in the three topics was higher than that for other topics presented in `Table 1`.

Our study reveals significant differences in collaboration patterns within the countries performing research on *Danube Delta* and *Black Sea* area, most of the publications and multi-authored. Our study results indicate that the collaboration of geographically specific areas, such as *Danube Delta* and *Black Sea*, is biased towards a few countries, which tend to exhibit specific behavior in term of citations and self-citations. An extended analysis will follow over all the keywords identified as significant for the analysis.

**Acknowledgements:** This work was financially supported by the Institutional Core Program `BIODIVERS-105 Project`.

# Appendix A

```{r, echo=FALSE, include=FALSE}
# Plot of documents and citations by country
#++++++++++++++++++++++++++++++++++++++++++++

dat.combined.Country = read.csv(paste0("dataIn/Country/", words$Key2[1],"_Country.csv"), stringsAsFactors = FALSE, skip = 7)
dat.combined.Country$Word = words$Key[1]

for (i in 2:length(words$Key)){
  print(i)
  dat = read.csv(paste0("dataIn/Country/", words$Key2[i],"_Country.csv"), stringsAsFactors = FALSE, skip = 7)
  dat$Word = words$Key[i]
  
  dat.combined.Country = rbind(dat.combined.Country, dat)
}

names(dat.combined.Country) = c("Country", "Articles", "Word")

# writing the file 
write.csv(dat.combined.Country, "dataOut/data_Combined_Country.csv")
```

For the keywords: `r words$Key[c(1,2)]` 


```{r, echo=FALSE, fig.show='hold', fig.width=8, fig.cap=fn("Documents per country")}
i = 1

# first
dat.wd1 = dat.combined.Country[which(dat.combined.Country$Word == words$Key[i]),]
dat.wd1 = dat.wd1[order(dat.wd1$Articles, decreasing = TRUE), ]

dat.wd1$Country = factor(dat.wd1$Country, levels = dat.wd1$Country[order(dat.wd1$Articles, decreasing = FALSE)])
  
plot.Country.wd1 = ggplot(data = dat.wd1[1:10,])+
  geom_bar(aes(x = Country, y = Articles, fill = Country), stat = "identity", colour = "#777777", width = 0.5)+ 
  scale_fill_brewer(palette = "Spectral")+
  geom_text(aes(x = Country, y = Articles, label = as.character(Articles)), 
            hjust = -0.5, color = "#444444", size = 3, fontface = "bold")+
  coord_flip(ylim = c(0, max(dat.wd1$Articles)+50))+
  theme_bw()+
  ggtitle(paste0('Documents by country for "', words$Key[i], '" keyword'))+
  labs(x = "", y = "Number of articles")+
  theme(legend.position = "none", 
        title = element_text(size = 10))

# second
dat.wd2 = dat.combined.Country[which(dat.combined.Country$Word == words$Key[i+1]),]
dat.wd2 = dat.wd2[order(dat.wd2$Articles, decreasing = TRUE), ]

dat.wd2$Country = factor(dat.wd2$Country, levels = dat.wd2$Country[order(dat.wd2$Articles, decreasing = FALSE)])

plot.Country.wd2 = ggplot(data = dat.wd2[1:10,])+
  geom_bar(aes(x = Country, y = Articles, fill = Country), stat = "identity", colour = "#777777", width = 0.5)+ 
  scale_fill_brewer(palette = "Spectral")+
  geom_text(aes(x = Country, y = Articles, label = as.character(Articles)), 
            hjust = -0.5, color = "#444444", size = 3, fontface = "bold")+
  coord_flip(ylim = c(0, max(dat.wd2$Articles)+50))+
  theme_bw()+
  ggtitle(paste0('Documents by country for "', words$Key[i+1], '" keyword'))+
  labs(x = "", y = "Number of articles")+
  theme(legend.position = "none", 
        title = element_text(size = 10))

multiplot(plot.Country.wd1, plot.Country.wd2, cols = 1)
```

For the keywords: `r words$Key[c(3,4)]` 


```{r, echo=FALSE, fig.show='hold', fig.width=8, fig.cap=fn("Documents per country")}
i = 3

# first
dat.wd1 = dat.combined.Country[which(dat.combined.Country$Word == words$Key[i]),]
dat.wd1 = dat.wd1[order(dat.wd1$Articles, decreasing = TRUE), ]

dat.wd1$Country = factor(dat.wd1$Country, levels = dat.wd1$Country[order(dat.wd1$Articles, decreasing = FALSE)])
  
plot.Country.wd1 = ggplot(data = dat.wd1[1:10,])+
  geom_bar(aes(x = Country, y = Articles, fill = Country), stat = "identity", colour = "#777777", width = 0.5)+ 
  scale_fill_brewer(palette = "Spectral")+
  geom_text(aes(x = Country, y = Articles, label = as.character(Articles)), 
            hjust = -0.5, color = "#444444", size = 3, fontface = "bold")+
  coord_flip(ylim = c(0, max(dat.wd1$Articles)+50))+
  theme_bw()+
  ggtitle(paste0('Documents by country for "', words$Key[i], '" keyword'))+
  labs(x = "", y = "Number of articles")+
  theme(legend.position = "none", 
        title = element_text(size = 10))

# second
dat.wd2 = dat.combined.Country[which(dat.combined.Country$Word == words$Key[i+1]),]
dat.wd2 = dat.wd2[order(dat.wd2$Articles, decreasing = TRUE), ]

dat.wd2$Country = factor(dat.wd2$Country, levels = dat.wd2$Country[order(dat.wd2$Articles, decreasing = FALSE)])

plot.Country.wd2 = ggplot(data = dat.wd2[1:10,])+
  geom_bar(aes(x = Country, y = Articles, fill = Country), stat = "identity", colour = "#777777", width = 0.5)+ 
  scale_fill_brewer(palette = "Spectral")+
  geom_text(aes(x = Country, y = Articles, label = as.character(Articles)), 
            hjust = -0.5, color = "#444444", size = 3, fontface = "bold")+
  coord_flip(ylim = c(0, max(dat.wd2$Articles)+50))+
  theme_bw()+
  ggtitle(paste0('Documents by country for "', words$Key[i+1], '" keyword'))+
  labs(x = "", y = "Number of articles")+
  theme(legend.position = "none", 
        title = element_text(size = 10))

multiplot(plot.Country.wd1, plot.Country.wd2, cols = 1)
```

For the keywords: `r words$Key[c(5,6)]` 


```{r, echo=FALSE, fig.show='hold', fig.width=8, fig.cap=fn("Documents per country")}
i = 5

# first
dat.wd1 = dat.combined.Country[which(dat.combined.Country$Word == words$Key[i]),]
dat.wd1 = dat.wd1[order(dat.wd1$Articles, decreasing = TRUE), ]

dat.wd1$Country = factor(dat.wd1$Country, levels = dat.wd1$Country[order(dat.wd1$Articles, decreasing = FALSE)])
  
plot.Country.wd1 = ggplot(data = dat.wd1[1:10,])+
  geom_bar(aes(x = Country, y = Articles, fill = Country), stat = "identity", colour = "#777777", width = 0.5)+ 
  scale_fill_brewer(palette = "Spectral")+
  geom_text(aes(x = Country, y = Articles, label = as.character(Articles)), 
            hjust = -0.5, color = "#444444", size = 3, fontface = "bold")+
  coord_flip(ylim = c(0, max(dat.wd1$Articles)+50))+
  theme_bw()+
  ggtitle(paste0('Documents by country for "', words$Key[i], '" keyword'))+
  labs(x = "", y = "Number of articles")+
  theme(legend.position = "none", 
        title = element_text(size = 10))

# second
dat.wd2 = dat.combined.Country[which(dat.combined.Country$Word == words$Key[i+1]),]
dat.wd2 = dat.wd2[order(dat.wd2$Articles, decreasing = TRUE), ]

dat.wd2$Country = factor(dat.wd2$Country, levels = dat.wd2$Country[order(dat.wd2$Articles, decreasing = FALSE)])

plot.Country.wd2 = ggplot(data = dat.wd2[1:10,])+
  geom_bar(aes(x = Country, y = Articles, fill = Country), stat = "identity", colour = "#777777", width = 0.5)+ 
  scale_fill_brewer(palette = "Spectral")+
  geom_text(aes(x = Country, y = Articles, label = as.character(Articles)), 
            hjust = -0.5, color = "#444444", size = 3, fontface = "bold")+
  coord_flip(ylim = c(0, max(dat.wd2$Articles)+50))+
  theme_bw()+
  ggtitle(paste0('Documents by country for "', words$Key[i+1], '" keyword'))+
  labs(x = "", y = "Number of articles")+
  theme(legend.position = "none", 
        title = element_text(size = 10))

multiplot(plot.Country.wd1, plot.Country.wd2, cols = 1)
```

For the keywords: `r words$Key[c(7,8)]` 


```{r, echo=FALSE, fig.show='hold', fig.width=8, fig.cap=fn("Documents per country")}
i = 7

# first
dat.wd1 = dat.combined.Country[which(dat.combined.Country$Word == words$Key[i]),]
dat.wd1 = dat.wd1[order(dat.wd1$Articles, decreasing = TRUE), ]

dat.wd1$Country = factor(dat.wd1$Country, levels = dat.wd1$Country[order(dat.wd1$Articles, decreasing = FALSE)])
  
plot.Country.wd1 = ggplot(data = dat.wd1[1:10,])+
  geom_bar(aes(x = Country, y = Articles, fill = Country), stat = "identity", colour = "#777777", width = 0.5)+ 
  scale_fill_brewer(palette = "Spectral")+
  geom_text(aes(x = Country, y = Articles, label = as.character(Articles)), 
            hjust = -0.5, color = "#444444", size = 3, fontface = "bold")+
  coord_flip(ylim = c(0, max(dat.wd1$Articles)+50))+
  theme_bw()+
  ggtitle(paste0('Documents by country for "', words$Key[i], '" keyword'))+
  labs(x = "", y = "Number of articles")+
  theme(legend.position = "none", 
        title = element_text(size = 10))

# second
dat.wd2 = dat.combined.Country[which(dat.combined.Country$Word == words$Key[i+1]),]
dat.wd2 = dat.wd2[order(dat.wd2$Articles, decreasing = TRUE), ]

dat.wd2$Country = factor(dat.wd2$Country, levels = dat.wd2$Country[order(dat.wd2$Articles, decreasing = FALSE)])

plot.Country.wd2 = ggplot(data = dat.wd2[1:10,])+
  geom_bar(aes(x = Country, y = Articles, fill = Country), stat = "identity", colour = "#777777", width = 0.5)+ 
  scale_fill_brewer(palette = "Spectral")+
  geom_text(aes(x = Country, y = Articles, label = as.character(Articles)), 
            hjust = -0.5, color = "#444444", size = 3, fontface = "bold")+
  coord_flip(ylim = c(0, max(dat.wd2$Articles)+50))+
  theme_bw()+
  ggtitle(paste0('Documents by country for "', words$Key[i+1], '" keyword'))+
  labs(x = "", y = "Number of articles")+
  theme(legend.position = "none", 
        title = element_text(size = 10))

multiplot(plot.Country.wd1, plot.Country.wd2, cols = 1)
```


For the keywords: `r words$Key[c(9,10)]` 


```{r, echo=FALSE, fig.show='hold', fig.width=8, fig.cap=fn("Documents per country")}
i = 9

# first
dat.wd1 = dat.combined.Country[which(dat.combined.Country$Word == words$Key[i]),]
dat.wd1 = dat.wd1[order(dat.wd1$Articles, decreasing = TRUE), ]

dat.wd1$Country = factor(dat.wd1$Country, levels = dat.wd1$Country[order(dat.wd1$Articles, decreasing = FALSE)])
  
plot.Country.wd1 = ggplot(data = dat.wd1[1:10,])+
  geom_bar(aes(x = Country, y = Articles, fill = Country), stat = "identity", colour = "#777777", width = 0.5)+ 
  scale_fill_brewer(palette = "Spectral")+
  geom_text(aes(x = Country, y = Articles, label = as.character(Articles)), 
            hjust = -0.5, color = "#444444", size = 3, fontface = "bold")+
  coord_flip(ylim = c(0, max(dat.wd1$Articles)+50))+
  theme_bw()+
  ggtitle(paste0('Documents by country for "', words$Key[i], '" keyword'))+
  labs(x = "", y = "Number of articles")+
  theme(legend.position = "none", 
        title = element_text(size = 10))

# second
dat.wd2 = dat.combined.Country[which(dat.combined.Country$Word == words$Key[i+1]),]
dat.wd2 = dat.wd2[order(dat.wd2$Articles, decreasing = TRUE), ]

dat.wd2$Country = factor(dat.wd2$Country, levels = dat.wd2$Country[order(dat.wd2$Articles, decreasing = FALSE)])

plot.Country.wd2 = ggplot(data = dat.wd2[1:10,])+
  geom_bar(aes(x = Country, y = Articles, fill = Country), stat = "identity", colour = "#777777", width = 0.5)+ 
  scale_fill_brewer(palette = "Spectral")+
  geom_text(aes(x = Country, y = Articles, label = as.character(Articles)), 
            hjust = -0.5, color = "#444444", size = 3, fontface = "bold")+
  coord_flip(ylim = c(0, max(dat.wd2$Articles)+50))+
  theme_bw()+
  ggtitle(paste0('Documents by country for "', words$Key[i+1], '" keyword'))+
  labs(x = "", y = "Number of articles")+
  theme(legend.position = "none", 
        title = element_text(size = 10))

multiplot(plot.Country.wd1, plot.Country.wd2, cols = 1)
```


For the keywords: `r words$Key[c(11,12)]` 


```{r, echo=FALSE, fig.show='hold', fig.width=8, fig.cap=fn("Documents per country")}
i = 11

# first
dat.wd1 = dat.combined.Country[which(dat.combined.Country$Word == words$Key[i]),]
dat.wd1 = dat.wd1[order(dat.wd1$Articles, decreasing = TRUE), ]

dat.wd1$Country = factor(dat.wd1$Country, levels = dat.wd1$Country[order(dat.wd1$Articles, decreasing = FALSE)])
  
plot.Country.wd1 = ggplot(data = dat.wd1[1:10,])+
  geom_bar(aes(x = Country, y = Articles, fill = Country), stat = "identity", colour = "#777777", width = 0.5)+ 
  scale_fill_brewer(palette = "Spectral")+
  geom_text(aes(x = Country, y = Articles, label = as.character(Articles)), 
            hjust = -0.5, color = "#444444", size = 3, fontface = "bold")+
  coord_flip(ylim = c(0, max(dat.wd1$Articles)+50))+
  theme_bw()+
  ggtitle(paste0('Documents by country for "', words$Key[i], '" keyword'))+
  labs(x = "", y = "Number of articles")+
  theme(legend.position = "none", 
        title = element_text(size = 10))

# second
dat.wd2 = dat.combined.Country[which(dat.combined.Country$Word == words$Key[i+1]),]
dat.wd2 = dat.wd2[order(dat.wd2$Articles, decreasing = TRUE), ]

dat.wd2$Country = factor(dat.wd2$Country, levels = dat.wd2$Country[order(dat.wd2$Articles, decreasing = FALSE)])

plot.Country.wd2 = ggplot(data = dat.wd2[1:10,])+
  geom_bar(aes(x = Country, y = Articles, fill = Country), stat = "identity", colour = "#777777", width = 0.5)+ 
  scale_fill_brewer(palette = "Spectral")+
  geom_text(aes(x = Country, y = Articles, label = as.character(Articles)), 
            hjust = -0.5, color = "#444444", size = 3, fontface = "bold")+
  coord_flip(ylim = c(0, max(dat.wd2$Articles)+50))+
  theme_bw()+
  ggtitle(paste0('Documents by country for "', words$Key[i+1], '" keyword'))+
  labs(x = "", y = "Number of articles")+
  theme(legend.position = "none", 
        title = element_text(size = 10))

multiplot(plot.Country.wd1, plot.Country.wd2, cols = 1)
```


For the keywords: `r words$Key[c(13,14)]` 


```{r, echo=FALSE, fig.show='hold', fig.width=8, fig.cap=fn("Documents per country")}
i = 13

# first
dat.wd1 = dat.combined.Country[which(dat.combined.Country$Word == words$Key[i]),]
dat.wd1 = dat.wd1[order(dat.wd1$Articles, decreasing = TRUE), ]

dat.wd1$Country = factor(dat.wd1$Country, levels = dat.wd1$Country[order(dat.wd1$Articles, decreasing = FALSE)])
  
plot.Country.wd1 = ggplot(data = dat.wd1[1:10,])+
  geom_bar(aes(x = Country, y = Articles, fill = Country), stat = "identity", colour = "#777777", width = 0.5)+ 
  scale_fill_brewer(palette = "Spectral")+
  geom_text(aes(x = Country, y = Articles, label = as.character(Articles)), 
            hjust = -0.5, color = "#444444", size = 3, fontface = "bold")+
  coord_flip(ylim = c(0, max(dat.wd1$Articles)+50))+
  theme_bw()+
  ggtitle(paste0('Documents by country for "', words$Key[i], '" keyword'))+
  labs(x = "", y = "Number of articles")+
  theme(legend.position = "none", 
        title = element_text(size = 10))

# second
dat.wd2 = dat.combined.Country[which(dat.combined.Country$Word == words$Key[i+1]),]
dat.wd2 = dat.wd2[order(dat.wd2$Articles, decreasing = TRUE), ]

dat.wd2$Country = factor(dat.wd2$Country, levels = dat.wd2$Country[order(dat.wd2$Articles, decreasing = FALSE)])

plot.Country.wd2 = ggplot(data = dat.wd2[1:10,])+
  geom_bar(aes(x = Country, y = Articles, fill = Country), stat = "identity", colour = "#777777", width = 0.5)+ 
  scale_fill_brewer(palette = "Spectral")+
  geom_text(aes(x = Country, y = Articles, label = as.character(Articles)), 
            hjust = -0.5, color = "#444444", size = 3, fontface = "bold")+
  coord_flip(ylim = c(0, max(dat.wd2$Articles)+50))+
  theme_bw()+
  ggtitle(paste0('Documents by country for "', words$Key[i+1], '" keyword'))+
  labs(x = "", y = "Number of articles")+
  theme(legend.position = "none", 
        title = element_text(size = 10))

multiplot(plot.Country.wd1, plot.Country.wd2, cols = 1)
```


For the keywords: `r words$Key[c(15,16)]` 


```{r, echo=FALSE, fig.show='hold', fig.width=8, fig.cap=fn("Documents per country")}
i = 15

# first
dat.wd1 = dat.combined.Country[which(dat.combined.Country$Word == words$Key[i]),]
dat.wd1 = dat.wd1[order(dat.wd1$Articles, decreasing = TRUE), ]

dat.wd1$Country = factor(dat.wd1$Country, levels = dat.wd1$Country[order(dat.wd1$Articles, decreasing = FALSE)])
  
plot.Country.wd1 = ggplot(data = dat.wd1[1:10,])+
  geom_bar(aes(x = Country, y = Articles, fill = Country), stat = "identity", colour = "#777777", width = 0.5)+ 
  scale_fill_brewer(palette = "Spectral")+
  geom_text(aes(x = Country, y = Articles, label = as.character(Articles)), 
            hjust = -0.5, color = "#444444", size = 3, fontface = "bold")+
  coord_flip(ylim = c(0, max(dat.wd1$Articles)+50))+
  theme_bw()+
  ggtitle(paste0('Documents by country for "', words$Key[i], '" keyword'))+
  labs(x = "", y = "Number of articles")+
  theme(legend.position = "none", 
        title = element_text(size = 10))

# second
dat.wd2 = dat.combined.Country[which(dat.combined.Country$Word == words$Key[i+1]),]
dat.wd2 = dat.wd2[order(dat.wd2$Articles, decreasing = TRUE), ]

dat.wd2$Country = factor(dat.wd2$Country, levels = dat.wd2$Country[order(dat.wd2$Articles, decreasing = FALSE)])

plot.Country.wd2 = ggplot(data = dat.wd2[1:10,])+
  geom_bar(aes(x = Country, y = Articles, fill = Country), stat = "identity", colour = "#777777", width = 0.5)+ 
  scale_fill_brewer(palette = "Spectral")+
  geom_text(aes(x = Country, y = Articles, label = as.character(Articles)), 
            hjust = -0.5, color = "#444444", size = 3, fontface = "bold")+
  coord_flip(ylim = c(0, max(dat.wd2$Articles)+50))+
  theme_bw()+
  ggtitle(paste0('Documents by country for "', words$Key[i+1], '" keyword'))+
  labs(x = "", y = "Number of articles")+
  theme(legend.position = "none", 
        title = element_text(size = 10))

multiplot(plot.Country.wd1, plot.Country.wd2, cols = 1)
```


# References

1. Bar-Ilan, J., (2009), "A closer look at the sources of informetric research", International Journal of Scientometrics, Infometrics Bibliometrics, 13(1), 1-9. 
2. Dangles., Loirat, J., Freour, C., Serre, S., Vacher, J., Le Roux, X., (2016), "Research on Biodiversity and Climate Change at a Distance: Collaboration Networks between Europe and Latin America and the Caribbean", PLOS ONE, June 15, 2016 http://dx.doi.org/10.1371/journal.pone.0157441.
3. Elsevier, (2013), "International Comparative Performance of the UK Research Base", Elsevier, 1-117.
4. Felton A, Fischer J, Lindenmayer DB, Montague-Drake R, Lowe AR, Saunders D, Felton AM, Steffen W, Munro NT, Youngentob K, Gillen J, Gibbons P, Bruzgul JE, Fazey I, Bond SJ, Elliott CP, Macdonald BCT, Porfirio LL, Westgate M, Worthy M (2009),  "Climate change, conservation and management: an assessment of the peer-reviewed scientific journal literature. Biodiversity and Conservation", 18, 2243-2253.
5. Ghane, M. R., (2011), "To What Extent Are Highly Cited Papers Influenced by Author Self-citation ? A Comparison between Iran and Turkey", International Journal of Information Science and Management, 9(1), 33-46.
6. Halevi, G., Moed, H.F., (2014), "10 years of research impact: top cited papers in Scopus 2001-2011", Research Trends, 38, 3-9.
7. Jaeschke, A., Bittner, T., Jentsch, A., Beierkuhnlein, C., (2014), "The last decade in ecological climate change impact research: where are we now ?", Naturwissenschaften, 101(1), 1-9.
8. Kim, J.,  Lee, S.,  Shim , W., Kang, J.,  A Mapping of Marine Biodiversity Research Trends and Collaboration in the East Asia Region from 1996â€“2015,  Sustainability 2016, 8(10), 1075; doi:10.3390/su8101075
9. Melin G, Persson O. Studying research collaboration using co-authorships, Scientometrics. 1996; 36: 363â€“377. doi: 10.1007/bf02129600
10. RELX, "The Climate Change Challenge: the global research landscape, RELX group 2015 report", (2015), http://www.relx.com/corporateresponsibility/Documents/climatechangescience.pdf
11. Sangwal, K., (2013), "Some citation-related characteristics of scientific journals published in individual countries", Scientometrics, 97(3), 719-741.
12. Taskin, Z., Al, U., (2014), "Standardization problem of author affiliations in citation indexes", Scientometrics 98(1), 347-368.
13. Zhang, Y.J.,  Liao, H., Li, G., i Yu, S.W., Wang, Z.H.,  Wei ,Y.M., (2012) "Climate Change Research Institute Rankings 2012", Center for Energy and Environmental Policy Research Beijing Institute of Technology, 2012, National Basic Research Program of China (973 Program) (No. 2010CB955805).
14. The LIFE 2014-2020 Regulation (EC) No 1293/2013 was published in the Official Journal L 347/185 of 20 December 2013.
